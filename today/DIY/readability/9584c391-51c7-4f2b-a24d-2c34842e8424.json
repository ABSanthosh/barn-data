{
  "id": "9584c391-51c7-4f2b-a24d-2c34842e8424",
  "title": "All The Attacks on the RP2350",
  "link": "https://hackaday.com/2025/01/15/all-the-attacks-on-the-rp2350/",
  "description": "Raspberry Pi’s new microcontroller, the RP2350, has a small section of memory that is meant for storing secrets. It’s protected by anti-glitching and other countermeasures, and the Raspberries wanted to …read more",
  "author": "Elliot Williams",
  "published": "Thu, 16 Jan 2025 00:02:10 +0000",
  "source": "https://hackaday.com/blog/feed/",
  "categories": [
    "Microcontrollers",
    "Raspberry Pi",
    "chip glitching",
    "raspberry pi",
    "security"
  ],
  "byline": "",
  "length": 2330,
  "excerpt": "Raspberry Pi’s new microcontroller, the RP2350, has a small section of memory that is meant for storing secrets. It’s protected by anti-glitching and other countermeasures, and the Rasp…",
  "siteName": "Hackaday",
  "favicon": "https://hackaday.com/wp-content/themes/hackaday-2/img/hackaday-logo_1024x1024.png?v=3",
  "text": "Skip to content Raspberry Pi’s new microcontroller, the RP2350, has a small section of memory that is meant for storing secrets. It’s protected by anti-glitching and other countermeasures, and the Raspberries wanted to test it. So this summer, they gave them out, pre-programmed with a secret string, as part of the badge for DEFCON attendees. The results of the cracking efforts are in, and it’s fair to say that the hackers have won. First place went to [Aedan Cullen], who also gave a great talk about how he did it at 38C3. One of the coolest features of the RP2350, from a hacker perspective, is that it has dual ARM and dual RISC-V cores onboard, and they can be swapped out by multiplexers. The security module has a critical register that has disable bits for both of these processors, but it turns out that the ARM disable bits have priority. When [Aedan] glitched the security module just right, it disabled the ARM cores but left the RISC-V cores running in the secure context, with full debug(!), and the game was over. As of yet, there is no mitigation for this one, because it’s baked into the secure boot module’s silicon. [Marius Muench] managed to pre-load malicious code into RAM and glitch a reboot-out-of-secure-mode on the USB module. This one is possibly fixable by checking other reboot flags. [Kévin Courdesses] has a sweet laser fault-injection rig that’s based on the 3D-printable OpenFlexure Delta Stage, which we’ve seen used for microscopy purposes, but here he’s bypassing the anti-glitching circuitry by exposing the die and hitting it hard with photons. Finally, [Andrew Zonenberg] and a team from IOActive went at the RP2350 with a focused ion beam and just read the memory, or at least the pairwise-OR of neighboring bits. Pulling this attack off isn’t cheap, and it’s a more general property of all anti-fuse memory cells that they can be read out this way. Chalk this up as a mostly-win for the offense in this case. If you want to read up on voltage glitching attacks yourself, and we promise we won’t judge, [Matthew Alt] has a great writeup on the topic. And ironically enough, one of his tools of choice is [Colin O’Flynn]’s RP2040-based Chip Shouter EMP glitcher, which he showed us how to make and use in this 2021 Remoticon talk.",
  "image": "https://hackaday.com/wp-content/uploads/2022/03/RaspberryPiSD.jpg",
  "html": "\u003cdiv id=\"readability-page-1\" class=\"page\"\u003e\u003cdiv id=\"page\"\u003e\n    \n\n    \u003cp\u003e\u003ca href=\"#content\"\u003eSkip to content\u003c/a\u003e\u003c/p\u003e\n\n    \u003cdiv id=\"content\"\u003e\n        \u003cmain id=\"main\" role=\"main\"\u003e\n\n        \n            \n\u003carticle itemscope=\"\" itemtype=\"http://schema.org/Article\" id=\"post-755015\"\u003e\n    \n\n    \u003cdiv itemprop=\"articleBody\"\u003e\n        \u003cp\u003eRaspberry Pi’s new microcontroller, the RP2350, has a small section of memory that is meant for storing secrets. It’s protected by anti-glitching and other countermeasures, and the Raspberries wanted to test it. So this summer, they gave them out, pre-programmed with a secret string, as part of the badge for DEFCON attendees. \u003ca href=\"https://www.raspberrypi.com/news/security-through-transparency-rp2350-hacking-challenge-results-are-in/\" target=\"_blank\"\u003eThe results of the cracking efforts are in\u003c/a\u003e, and it’s fair to say that the hackers have won.\u003c/p\u003e\n\u003cp\u003eFirst place went to [Aedan Cullen], who also \u003ca href=\"https://media.ccc.de/v/38c3-hacking-the-rp2350\" target=\"_blank\"\u003egave a great talk about how he did it at 38C3\u003c/a\u003e. One of the coolest features of the RP2350, from a hacker perspective, is that it has dual ARM \u003cem\u003eand\u003c/em\u003e dual RISC-V cores onboard, and they can be swapped out by multiplexers. The security module has a critical register that has disable bits for both of these processors, but it turns out that the ARM disable bits have priority. When [Aedan] glitched the security module just right, it disabled the ARM cores but left the RISC-V cores running in the secure context, with full debug(!), and the game was over. As of yet, there is no mitigation for this one, because it’s baked into the secure boot module’s silicon.\u003c/p\u003e\n\u003cp\u003e[Marius Muench] managed to pre-load malicious code into RAM and glitch a reboot-out-of-secure-mode on the USB module. This one is possibly fixable by checking other reboot flags. [\u003ca href=\"https://courk.cc/rp2350-challenge-laser\" target=\"_blank\"\u003eKévin Courdesses] has a sweet laser fault-injection rig\u003c/a\u003e that’s based on the 3D-printable \u003ca href=\"https://build.openflexure.org/openflexure-delta-stage/v1.2.2/\" target=\"_blank\"\u003eOpenFlexure Delta Stage\u003c/a\u003e, which we’ve seen used for microscopy purposes, but here he’s bypassing the anti-glitching circuitry by exposing the die and hitting it hard with photons.\u003c/p\u003e\n\u003cp\u003eFinally, [Andrew Zonenberg] and a team from IOActive went at the RP2350 with a \u003ca href=\"https://en.wikipedia.org/wiki/Focused_ion_beam\" target=\"_blank\"\u003efocused ion beam\u003c/a\u003e and just read the memory, or at least the pairwise-OR of neighboring bits. Pulling this attack off isn’t cheap, and it’s a more general property of all anti-fuse memory cells that they can be read out this way. Chalk this up as a mostly-win for the offense in this case.\u003c/p\u003e\n\u003cp\u003eIf you want to read up on voltage glitching attacks yourself, and we promise we won’t judge, [Matthew Alt] \u003ca href=\"https://hackaday.com/2022/08/25/everything-you-didnt-know-you-need-to-know-about-glitching-attacks/\"\u003ehas a great writeup on the topic.\u003c/a\u003e And ironically enough, one of his tools of choice is [Colin O’Flynn]’s RP2040-based Chip Shouter EMP glitcher, which he showed us \u003ca href=\"https://hackaday.com/2022/02/03/remoticon-2021-colin-oflynn-zaps-chips-and-they-talk/\"\u003ehow to make and use in this 2021 Remoticon talk\u003c/a\u003e.\u003c/p\u003e\n\t            \u003c/div\u003e\n    \u003cul\u003e\n    \t\t\t\t\t\u003cli\u003e\n    \t\t\t\t\u003ca href=\"https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fhackaday.com%2F2025%2F01%2F15%2Fall-the-attacks-on-the-rp2350%2F\" target=\"_blank\"\u003e\n    \t\t\t\t\t\u003ci\u003e\u003cimg src=\"https://hackaday.com/wp-content/themes/hackaday-2/img/share_face.png\"/\u003e \u003c/i\u003e\n    \t\t\t\t\t\t\t\t\t\u003c/a\u003e\n    \t\t\t\u003c/li\u003e\n    \t\t\t\t\t\u003cli\u003e\n                        \u003ca href=\"https://twitter.com/intent/tweet?text=All%20The%20Attacks%20On%20The%20RP2350%20via%20@hackaday\u0026amp;url=https://hackaday.com/2025/01/15/all-the-attacks-on-the-rp2350/\" target=\"_blank\"\u003e\n    \t\t\t\t\t\u003ci\u003e\u003cimg src=\"https://hackaday.com/wp-content/themes/hackaday-2/img/share_twitter.png\"/\u003e\u003c/i\u003e\n    \t\t\t\t\t\t\t\t\t\u003c/a\u003e\n    \t\t\t\u003c/li\u003e\n    \t\t\t\t\t\u003cli\u003e\n    \t\t\t\t\u003ca href=\"https://www.linkedin.com/shareArticle?url=https%3A%2F%2Fhackaday.com%2F2025%2F01%2F15%2Fall-the-attacks-on-the-rp2350%2F\" target=\"_blank\"\u003e\n    \t\t\t\t\t\u003ci\u003e\u003cimg src=\"https://hackaday.com/wp-content/themes/hackaday-2/img/share_in.png\"/\u003e\u003c/i\u003e\n    \t\t\t\t\t\t\t\t\t\u003c/a\u003e\n    \t\t\t\u003c/li\u003e\n    \t\t\t\t\t\u003cli\u003e\n                \u003ca href=\"mailto:?subject=All+The+Attacks+On+The+RP2350 | Hackaday\u0026amp;body=https%3A%2F%2Fhackaday.com%2F2025%2F01%2F15%2Fall-the-attacks-on-the-rp2350%2F\"\u003e\n    \t\t\t\t\t\u003ci\u003e\u003cimg src=\"https://hackaday.com/wp-content/themes/hackaday-2/img/share_mail1.png\"/\u003e\u003c/i\u003e\n    \t\t\t\t\t\t\t\t\t\u003c/a\u003e\n    \t\t\t\u003c/li\u003e\n    \t\t\t\u003c/ul\u003e\n    \n\u003c/article\u003e\n\n            \t\n\t\n            \n\n            \n\n\n        \n        \n\n        \n        \n\n        \n        \u003c/main\u003e\n    \u003c/div\u003e\n\n\u003c/div\u003e\u003c/div\u003e",
  "readingTime": "3 min read",
  "publishedTime": "2025-01-16T00:02:10Z",
  "modifiedTime": "2025-01-16T00:02:10Z"
}
