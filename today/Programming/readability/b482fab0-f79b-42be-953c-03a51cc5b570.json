{
  "id": "b482fab0-f79b-42be-953c-03a51cc5b570",
  "title": "Using Home Assistant to integrate a Unifi Protect G4 Doorbell and Amazon Alexa to announce visitors",
  "link": "http://feeds.hanselman.com/~/676711904/0/scotthanselman~Using-Home-Assistant-to-integrate-a-Unifi-Protect-G-Doorbell-and-Amazon-Alexa-to-announce-visitors",
  "description": "I am not a Home Assistant expert, but it's clearly a massive and powerful ecosystem. I've interviewed the creator of Home Assistant on my podcast and I encourage you to check out that chat. Home Assistant can quickly become a hobby that overwhelms you. Every object (entity) in your house that is even remotely connected can become programmable. Everything. Even people! You can declare that any name:value pair that (for example) your phone can expose can be consumable by Home Assistant. Questions like \"is Scott home\" or \"what's Scott's phone battery\" can be associated with Scott the Entity in the Home Assistant Dashboard. I was amazed at the devices/objects that Home Assistant discovered that it could automate. Lights, remotes, Spotify, and more. You'll find that any internally connected device you have likely has an Integration available. Temperature, Light Status, sure, that's easy Home Automation. But integrations and 3rd party code can give you details like \"Is the Living Room dark\" or \"is there motion in the driveway.\" From these building blocks, you can then build your own IFTTT (If This Then That) automations, combining not just two systems, but any and all disparate systems. What's the best part? This all runs LOCALLY. Not in a cloud or the cloud or anyone's cloud. I've got my stuff running on a Raspberry Pi 4. Even better I put a Power Over Ethernet (PoE) hat on my Rpi so I have just one network wire into my hub that powers the Pi. I believe setting up Home Assistant on a Pi is the best and easiest way to get started. That said, you can also run in a Docker Container, on a Synology or other NAS, or just on Windows or Mac in the background. It's up to you. Optionally, you can pay Nabu Casa $5 for remote (outside your house) network access via transparent forwarding. But to be clear, it all still runs inside your house and not in the cloud. OK, to the main point. I used to have an Amazon Ring Doorbell that would integrate with Amazon Alexa and when you pressed the doorbell it would say \"Someone is at the front door\" on our all Alexas. It was a lovely little integration that worked nicely in our lives. However, I swapped out the Ring for a Unifi Protect G4 Doorbell for a number of reasons. I don't want to pump video to outside services, so this doorbell integrates nicely with my existing Unifi installation and records video to a local hard drive. However, I lose any Alexa integration and this nice little \"someone is at the door\" announcement. So this seems like a perfect job for Home Assistant. Here's the general todo list: Install Home Assistant Install Home Assistant Community Store This enables 3rd party \"untrusted\" integrations directly from GitHub. You'll need a GitHub account and it'll clone custom integrations directly into your local HA. I also recommend the Terminal \u0026 SSH (9.2.2), File editor (5.3.3) add ons so you can see what's happening. Get the UniFi Protect 3rd party integration for Home Assistant NOTE: Unifi Protect support is being promoted in Home Assistant v2022.2 so you won't need this step soon as it'll be included. \"The UniFi Protect Integration adds support for retrieving Camera feeds and Sensor data from a UniFi Protect installation on either an Ubiquiti CloudKey+, Ubiquiti UniFi Dream Machine Pro or UniFi Protect Network Video Recorder.\" Authenticate and configure this integration. Get the Alexa Media Player integration This makes all your Alexas show up in Home Assistant as \"media players\" and also allows you to tts (text to speech) to them. Authenticate and configure this integration. I recommend going into your Alexa app and making a Multi-room Speaker Group called \"everywhere.\" Not only because it's nice to be able to say \"play the music everywhere\" but you can also target that \"Everywhere\" group in Home Assistant. Go into your Home Assistant UI at http://homeassistant.local:8123/ and into Developer Tools. Under Services, try pasting in this YAML and clicking \"call service.\"service: notify.alexa_media_everywhere data: message: Someone is at the front door, this is a test data: type: announce method: speak If that works, you know you can automate Alexa and make it say things. Now, go to Configuration, Automation, and Add a new Automation. Here's mine. I used the UI to create it. Note that your Entity names may be different if you give your front doorbell camera a different name. Notice the format of Data, it's name value pairs within a single field's value. ...but it also exists in a file called Automations.yaml. Note that the \"to: 'on'\" trigger is required or you'll get double announcements, one for each state change in the doorbell. - id: '1640995128073' alias: G4 Doorbell Announcement with Alexa description: G4 Doorbell Announcement with Alexa trigger: - platform: state entity_id: binary_sensor.front_door_doorbell to: 'on' condition: [] action: - service: notify.alexa_media_everywhere data: data: type: announce method: speak message: Someone is at the front door mode: single It works! There's a ton of cool stuff I can automate now! Sponsor: Make login Auth0’s problem. Not yours. Provide the convenient login features your customers want, like social login, multi-factor authentication, single sign-on, passwordless, and more. Get started for free.© 2021 Scott Hanselman. All rights reserved.",
  "author": "Scott Hanselman",
  "published": "Tue, 14 Dec 2021 21:36:00 GMT",
  "source": "http://feeds.hanselman.com/ScottHanselman",
  "categories": [
    "Home Server",
    "Musings"
  ],
  "byline": "Scott Hanselman",
  "length": 5875,
  "excerpt": "I am not a Home Assistant expert, but it's clearly a massive and powerful ...",
  "siteName": "",
  "favicon": "https://images.hanselman.com/main/apple-touch-icon-114x114.png",
  "text": "I am not a Home Assistant expert, but it's clearly a massive and powerful ecosystem. I've interviewed the creator of Home Assistant on my podcast and I encourage you to check out that chat. Home Assistant can quickly become a hobby that overwhelms you. Every object (entity) in your house that is even remotely connected can become programmable. Everything. Even people! You can declare that any name:value pair that (for example) your phone can expose can be consumable by Home Assistant. Questions like \"is Scott home\" or \"what's Scott's phone battery\" can be associated with Scott the Entity in the Home Assistant Dashboard. I was amazed at the devices/objects that Home Assistant discovered that it could automate. Lights, remotes, Spotify, and more. You'll find that any internally connected device you have likely has an Integration available. Temperature, Light Status, sure, that's easy Home Automation. But integrations and 3rd party code can give you details like \"Is the Living Room dark\" or \"is there motion in the driveway.\" From these building blocks, you can then build your own IFTTT (If This Then That) automations, combining not just two systems, but any and all disparate systems. What's the best part? This all runs LOCALLY. Not in a cloud or the cloud or anyone's cloud. I've got my stuff running on a Raspberry Pi 4. Even better I put a Power Over Ethernet (PoE) hat on my Rpi so I have just one network wire into my hub that powers the Pi. I believe setting up Home Assistant on a Pi is the best and easiest way to get started. That said, you can also run in a Docker Container, on a Synology or other NAS, or just on Windows or Mac in the background. It's up to you. Optionally, you can pay Nabu Casa $5 for remote (outside your house) network access via transparent forwarding. But to be clear, it all still runs inside your house and not in the cloud. OK, to the main point. I used to have an Amazon Ring Doorbell that would integrate with Amazon Alexa and when you pressed the doorbell it would say \"Someone is at the front door\" on our all Alexas. It was a lovely little integration that worked nicely in our lives. However, I swapped out the Ring for a Unifi Protect G4 Doorbell for a number of reasons. I don't want to pump video to outside services, so this doorbell integrates nicely with my existing Unifi installation and records video to a local hard drive. However, I lose any Alexa integration and this nice little \"someone is at the door\" announcement. So this seems like a perfect job for Home Assistant. Here's the general todo list: Install Home Assistant Install Home Assistant Community Store This enables 3rd party \"untrusted\" integrations directly from GitHub. You'll need a GitHub account and it'll clone custom integrations directly into your local HA. I also recommend the Terminal \u0026 SSH (9.2.2), File editor (5.3.3) add ons so you can see what's happening. Get the UniFi Protect 3rd party integration for Home Assistant NOTE: Unifi Protect support is being promoted in Home Assistant v2022.2 so you won't need this step soon as it'll be included. \"The UniFi Protect Integration adds support for retrieving Camera feeds and Sensor data from a UniFi Protect installation on either an Ubiquiti CloudKey+, Ubiquiti UniFi Dream Machine Pro or UniFi Protect Network Video Recorder.\" Authenticate and configure this integration. Get the Alexa Media Player integration This makes all your Alexas show up in Home Assistant as \"media players\" and also allows you to tts (text to speech) to them. Authenticate and configure this integration. I recommend going into your Alexa app and making a Multi-room Speaker Group called \"everywhere.\" Not only because it's nice to be able to say \"play the music everywhere\" but you can also target that \"Everywhere\" group in Home Assistant. Go into your Home Assistant UI at http://homeassistant.local:8123/ and into Developer Tools. Under Services, try pasting in this YAML and clicking \"call service.\"service: notify.alexa_media_everywhere data: message: Someone is at the front door, this is a test data: type: announce method: speak If that works, you know you can automate Alexa and make it say things. Now, go to Configuration, Automation, and Add a new Automation. Here's mine. I used the UI to create it. Note that your Entity names may be different if you give your front doorbell camera a different name. Notice the format of Data, it's name value pairs within a single field's value. ...but it also exists in a file called Automations.yaml. Note that the \"to: 'on'\" trigger is required or you'll get double announcements, one for each state change in the doorbell. - id: '1640995128073' alias: G4 Doorbell Announcement with Alexa description: G4 Doorbell Announcement with Alexa trigger: - platform: state entity_id: binary_sensor.front_door_doorbell to: 'on' condition: [] action: - service: notify.alexa_media_everywhere data: data: type: announce method: speak message: Someone is at the front door mode: single It works! There's a ton of cool stuff I can automate now! Sponsor: Make login Auth0’s problem. Not yours. Provide the convenient login features your customers want, like social login, multi-factor authentication, single sign-on, passwordless, and more. Get started for free. About Scott Scott Hanselman is a former professor, former Chief Architect in finance, now speaker, consultant, father, diabetic, and Microsoft employee. He is a failed stand-up comic, a cornrower, and a book author. About   Newsletter Hosting By",
  "image": "https://www.hanselman.com/blog/content/binary/Windows-Live-Writer/Using-Home-Assistant_E31C/image_c613af81-10de-49d3-aead-6e174ca870ca.png",
  "html": "\u003cdiv id=\"readability-page-1\" class=\"page\"\u003e\u003csection\u003e\n            \n            \u003cp\u003eI am not a \u003ca href=\"https://www.home-assistant.io/\"\u003eHome Assistant\u003c/a\u003e expert, but it\u0026#39;s clearly a massive and powerful ecosystem. I\u0026#39;ve interviewed \u003ca href=\"https://hanselminutes.com/788/automating-all-the-things-with-home-assistants-paulus-schoutsen\"\u003ethe creator of Home Assistant on my podcast\u003c/a\u003e and I encourage you to check out that chat.\u003c/p\u003e \u003cp\u003eHome Assistant can quickly become a hobby that overwhelms you. Every object (entity) in your house that is even remotely connected can become programmable. Everything. Even people! You can declare that any name:value pair that (for example) your phone can expose can be consumable by Home Assistant. Questions like \u0026#34;is Scott home\u0026#34; or \u0026#34;what\u0026#39;s Scott\u0026#39;s phone battery\u0026#34; can be associated with Scott the Entity in the Home Assistant Dashboard. \u003c/p\u003e \u003cblockquote\u003e \u003cp\u003eI was amazed at the devices/objects that Home Assistant discovered that it could automate. Lights, remotes, Spotify, and more. You\u0026#39;ll find that any internally connected device you have likely has an Integration available.\u003c/p\u003e\u003c/blockquote\u003e \u003cp\u003eTemperature, Light Status, sure, that\u0026#39;s easy Home Automation. But integrations and 3rd party code can give you details like \u0026#34;Is the Living Room dark\u0026#34; or \u0026#34;is there motion in the driveway.\u0026#34; From these building blocks, you can then build your own IFTTT (If This Then That) automations, combining not just two systems, but any and all disparate systems.\u003c/p\u003e \u003cp\u003eWhat\u0026#39;s the best part? This all runs LOCALLY. Not in a cloud or the cloud or anyone\u0026#39;s cloud. I\u0026#39;ve got my stuff running on a \u003ca href=\"https://amzn.to/3HnJ3IY\"\u003eRaspberry Pi 4\u003c/a\u003e. Even better I put a \u003ca href=\"https://amzn.to/3HnJ3IY\"\u003ePower Over Ethernet (PoE) hat on my Rpi\u003c/a\u003e so I have just one network wire into my hub that powers the Pi.\u003c/p\u003e \u003cp\u003eI believe setting up \u003ca href=\"https://www.home-assistant.io/installation/raspberrypi/\"\u003eHome Assistant on a Pi\u003c/a\u003e is the best and easiest way to get started. That said, you can also run in a Docker Container, on a Synology or other NAS, or just on Windows or Mac in the background. It\u0026#39;s up to you. Optionally, you can pay \u003ca href=\"https://www.nabucasa.com/\"\u003eNabu Casa\u003c/a\u003e $5 for remote (outside your house) network access via transparent forwarding. But to be clear, it all still runs inside your house and not in the cloud.\u003c/p\u003e \u003cp\u003e\u003cimg title=\"Basic Home Assistant Setup\" alt=\"Basic Home Assistant Setup\" src=\"https://hanselmanblogcontent.azureedge.net/Windows-Live-Writer/Using-Home-Assistant_E31C/image_c613af81-10de-49d3-aead-6e174ca870ca.png\" width=\"600\" height=\"550\"/\u003e\u003c/p\u003e \u003cp\u003eOK, to the main point. I used to have an Amazon Ring Doorbell that would integrate with Amazon Alexa and when you pressed the doorbell it would say \u0026#34;Someone is at the front door\u0026#34; on our all Alexas. It was a lovely little integration that worked nicely in our lives.\u003c/p\u003e \u003cp\u003e\u003cimg title=\"Front Door UniFi G4 Doorbell\" alt=\"Front Door UniFi G4 Doorbell\" src=\"https://hanselmanblogcontent.azureedge.net/Windows-Live-Writer/Using-Home-Assistant_E31C/image_165ff623-cdc3-40c0-9caf-46686032f539.png\" width=\"485\" height=\"357\"/\u003e\u003c/p\u003e \u003cp\u003eHowever, I swapped out the Ring for a \u003ca href=\"https://hacs.xyz/\"\u003eUnifi Protect G4 Doorbell\u003c/a\u003e for a number of reasons. I don\u0026#39;t want to pump video to outside services, so this doorbell integrates nicely with my \u003ca href=\"https://www.hanselman.com/blog/review-unifi-from-ubiquiti-networking-is-the-ultimate-prosumer-home-networking-solution\"\u003eexisting Unifi installation\u003c/a\u003e and records video to a local hard drive. However, I lose any Alexa integration and this nice little \u0026#34;someone is at the door\u0026#34; announcement. So this seems like a perfect job for Home Assistant.\u003c/p\u003e \u003cp\u003eHere\u0026#39;s the general todo list:\u003c/p\u003e \u003cul\u003e \u003cli\u003eInstall \u003ca href=\"https://www.home-assistant.io/getting-started/\"\u003eHome Assistant\u003c/a\u003e\u003c/li\u003e \u003cli\u003eInstall \u003ca href=\"https://hacs.xyz/\"\u003eHome Assistant Community Store\u003c/a\u003e\u003c/li\u003e \u003cul\u003e \u003cli\u003eThis enables 3rd party \u0026#34;untrusted\u0026#34; integrations directly from GitHub. You\u0026#39;ll need a GitHub account and it\u0026#39;ll clone custom integrations directly into your local HA.\u003c/li\u003e \u003cli\u003eI also recommend the Terminal \u0026amp; SSH (9.2.2), File editor (5.3.3) add ons so you can see what\u0026#39;s happening.\u003c/li\u003e\u003c/ul\u003e \u003cli\u003eGet the \u003ca href=\"https://github.com/briis/unifiprotect\"\u003eUniFi Protect 3rd party integration for Home Assistant\u003c/a\u003e\u003c/li\u003e \u003cul\u003e \u003cli\u003e\u003cstrong\u003eNOTE\u003c/strong\u003e: Unifi Protect support is being promoted in Home Assistant v2022.2 so you won\u0026#39;t need this step soon as it\u0026#39;ll be included.\u003c/li\u003e \u003cli\u003e\u0026#34;The UniFi Protect Integration adds support for retrieving Camera feeds and Sensor data from a UniFi Protect installation on either an Ubiquiti CloudKey+, Ubiquiti UniFi Dream Machine Pro or UniFi Protect Network Video Recorder.\u0026#34;\u003c/li\u003e \u003cli\u003eAuthenticate and configure this integration.\u003c/li\u003e\u003c/ul\u003e \u003cli\u003eGet the \u003ca href=\"https://github.com/custom-components/alexa_media_player\"\u003eAlexa Media Player\u003c/a\u003e integration\u003c/li\u003e \u003cul\u003e \u003cli\u003eThis makes all your Alexas show up in Home Assistant as \u0026#34;media players\u0026#34; and also allows you to tts (text to speech) to them.\u003c/li\u003e \u003cli\u003eAuthenticate and configure this integration.\u003c/li\u003e\u003c/ul\u003e\u003c/ul\u003e \u003cp\u003eI recommend going into your Alexa app and making a Multi-room Speaker Group called \u0026#34;everywhere.\u0026#34; Not only because it\u0026#39;s nice to be able to say \u0026#34;play the music everywhere\u0026#34; but you can also target that \u0026#34;Everywhere\u0026#34; group in Home Assistant.\u003c/p\u003e \u003cp\u003eGo into your Home Assistant UI at \u003ca title=\"http://homeassistant.local:8123/\" href=\"http://homeassistant.local:8123/\"\u003ehttp://homeassistant.local:8123/\u003c/a\u003e and into \u003ca href=\"https://www.home-assistant.io/docs/tools/dev-tools/\"\u003eDeveloper Tools\u003c/a\u003e. Under Services, try pasting in this YAML and clicking \u0026#34;call service.\u0026#34;\u003c/p\u003e\u003cpre\u003eservice: notify.alexa_media_everywhere\ndata:\n  message: Someone is at the front door, this is a test\n  data:\n    type: announce\n    method: speak\u003c/pre\u003e\n\u003cp\u003eIf that works, you know you can automate Alexa and make it say things. Now, go to Configuration, Automation, and Add a new Automation. Here\u0026#39;s mine. I used the UI to create it. Note that your Entity names may be different if you give your front doorbell camera a different name.\u003c/p\u003e\n\u003cp\u003e\u003cimg title=\"Binary_sensor.front_door_doorbell\" alt=\"Binary_sensor.front_door_doorbell\" src=\"https://hanselmanblogcontent.azureedge.net/Windows-Live-Writer/Using-Home-Assistant_E31C/image_6c40ad44-b67e-422c-97c8-41741af21066.png\" width=\"404\" height=\"389\"/\u003e\u003c/p\u003e\n\u003cp\u003eNotice the format of Data, it\u0026#39;s name value pairs within a single field\u0026#39;s value.\u003c/p\u003e\n\u003cp\u003e\u003cimg title=\"Alexa Action\" alt=\"Alexa Action\" src=\"https://hanselmanblogcontent.azureedge.net/Windows-Live-Writer/Using-Home-Assistant_E31C/image_5a58a5af-dd88-40f5-9c62-93202dbdf409.png\" width=\"815\" height=\"682\"/\u003e\u003c/p\u003e\n\u003cp\u003e...but it also exists in a file called Automations.yaml. Note that the \u0026#34;to: \u0026#39;on\u0026#39;\u0026#34; trigger is required or you\u0026#39;ll get double announcements, one for \u003cem\u003eeach state change \u003c/em\u003ein the doorbell. \u003c/p\u003e\u003cpre\u003e- id: \u0026#39;1640995128073\u0026#39;\n  alias: G4 Doorbell Announcement with Alexa\n  description: G4 Doorbell Announcement with Alexa\n  trigger:\n  - platform: state\n    entity_id: binary_sensor.front_door_doorbell\n    to: \u0026#39;on\u0026#39;\n  condition: []\n  action:\n  - service: notify.alexa_media_everywhere\n    data:\n      data:\n        type: announce\n        method: speak\n      message: Someone is at the front door\n  mode: single\u003c/pre\u003e\n\u003cp\u003eIt works! There\u0026#39;s a ton of cool stuff I can automate now!\u003c/p\u003e\n\u003chr/\u003e\n\n\u003cp\u003e\u003cstrong\u003eSponsor:\u003c/strong\u003e Make login Auth0’s problem. Not yours. Provide the convenient login features your customers want, like social login, multi-factor authentication, single sign-on, passwordless, and more. \u003ca href=\"https://hnsl.mn/34dSTyP\"\u003eGet started for free.\u003c/a\u003e\u003c/p\u003e\n\n\n\n            \u003cdiv\u003e\n                \u003cdiv\u003e\n                    \u003ch4\u003eAbout Scott\u003c/h4\u003e\n                    \u003cdiv\u003e\n                        \u003cp\u003eScott Hanselman is a former professor, former Chief Architect in finance, now speaker, consultant, father, diabetic, and Microsoft employee. He is a failed stand-up comic, a cornrower, and a book author.\u003c/p\u003e\n                        \u003cp\u003e\u003ca href=\"https://facebook.com/shanselman\"\u003e\u003cimg src=\"http://images.hanselman.com/main/icon-fb.png\" alt=\"facebook\"/\u003e\u003c/a\u003e\n                        \u003ca href=\"https://twitter.com/shanselman\"\u003e\u003cimg src=\"http://images.hanselman.com/main/icon-twitter.png\" alt=\"twitter\"/\u003e\u003c/a\u003e\n                        \u003ca href=\"http://feeds.hanselman.com/ScottHanselman\"\u003e\u003cimg src=\"http://images.hanselman.com/main/icon-rss.png\" alt=\"subscribe\"/\u003e\u003c/a\u003e\u003cbr/\u003e\n                        \u003ca href=\"http://hanselman.com/about\"\u003eAbout\u003c/a\u003e   \u003ca href=\"http://www.hanselman.com/newsletter\"\u003eNewsletter\u003c/a\u003e\n                    \u003c/p\u003e\u003c/div\u003e\n                \u003c/div\u003e\n\n                \u003cdiv\u003e\n                    \u003cp\u003e\u003cstrong\u003eHosting By\u003c/strong\u003e\u003cbr/\u003e\n                        \u003ca rel=\"nofollow\" href=\"https://azure.microsoft.com/free\"\u003e\u003cimg alt=\"Hosted in an Azure App Service\" width=\"125\" height=\"125\" src=\"http://images.hanselman.com/main/azure-250x250.png\"/\u003e\u003c/a\u003e\n                    \u003c/p\u003e\n\n                \u003c/div\u003e\n            \u003c/div\u003e\n\n            \n\n\n            \n\n            \n        \u003c/section\u003e\u003c/div\u003e",
  "readingTime": "7 min read",
  "publishedTime": null,
  "modifiedTime": null
}
