{
  "id": "183715f2-51cb-475e-b4f2-1ec7d3a36257",
  "title": "Reinventing the dial-up modem",
  "link": "https://saket.me/dtmf-tones/",
  "description": "While working on a healthcare app called Simple at my previous company, we wanted to improve how nurses follow up with their patients. The aim was to replace traditional paper registers + landline phones with the app, which could intelligently suggest patients who are potentially at risk based on their medical history, age, and other […] The post Reinventing the dial-up modem appeared first on Saket Narayan.",
  "author": "Saket Narayan",
  "published": "Sun, 18 Aug 2019 00:55:04 +0000",
  "source": "https://saket.me/feed/",
  "categories": [
    "Android",
    "dtmf",
    "offline first",
    "simple"
  ],
  "byline": "Saket Narayan",
  "length": 4329,
  "excerpt": "Modern problems sometime require traditional solutions",
  "siteName": "Saket Narayan",
  "favicon": "",
  "text": "While working on a healthcare app called Simple at my previous company, we wanted to improve how nurses follow up with their patients. The aim was to replace traditional paper registers + landline phones with the app, which could intelligently suggest patients who are potentially at risk based on their medical history, age, and other important cues. For protecting their privacy, we needed to route their phone calls through a proxy so that their personal numbers stayed hidden from their patients. This is referred to as “phone number masking” and is commonly used these days. When you take a ride with Uber, or order food with Zomato, both you and your driver/rider are assigned temporary numbers for privacy for the duration of the trip/task. When your driver dials your proxy number, Uber forwards the call to your actual phone number. The plan was similar for Simple, but there was one problem with this approach: talking to the server required an internet connection. We wanted to keep Simple offline-first. While it’s nice to have a data connection, it was important for the app’s functionality to not degrade when a connection is unavailable, especially in remote villages. We needed a way to send data to our server without an internet connection. A team member came up with this fantastic idea of using DTMF tones! DTMF stands for Dual Tone – Multi Frequency. It’s the tone your phone plays when you press a number on the dial-pad during an ongoing phone call. Each number is assigned a combination of two sine waves for identifying its row and column indices on the dial-pad. Turns out, DTMF tones are great. They are easy to implement and most communication-as-a-service platforms support them out of the box. On Android, DTMF tones can be played using a call Intent: \u003cspan class=\"token keyword\"\u003eval\u003c/span\u003e dtmfTones \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e patientNumber \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"#\"\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eval\u003c/span\u003e numberToCall \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e tollFreeNumber \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e \u003cspan class=\"token string\"\u003e\",\"\u003c/span\u003e \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e dtmfTones \u003cspan class=\"token keyword\"\u003eval\u003c/span\u003e numberUri \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e Uri\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003efromParts\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"tel\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e phoneNumber\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token keyword\"\u003enull\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e context\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003estartActivity\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token function\"\u003eIntent\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eIntent\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eACTION_CALL\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e numberUri\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e When a nurse clicks a patient’s call button, the app dials our toll-free number and plays the patient’s number as DTMF tones. The server receives the patient’s number through Twilio (which does the job of decoding DTMF tones) and in turn, connects the nurse with the intended patient. Here’s what the call sounds like: (If you’re seeing this text, it probably means that your browser does not support HTML5 audio.) It would have been nice if we could customize how DTMF tones are encoded because playing a phone number takes quite long, but it’s alright considering they’ll only be used when an internet connection is unavailable. By now you’ve probably realized why this technology feels so familiar. If you’re still not convinced that DTMF tones are cool then let me introduce you to “phone phreaking”: Before They Created Apple, Jobs And Wozniak Hacked The Phone System | FiveThirtyEight. Exercise for the reader If 1800-XXX-XXXX is your network company’s customer support number and 9 is the number you press on the dialpad after hearing a recorded message for 20s to reach a human, what happens if you dial 1800-XXX-XXXX,9 directly? The dialer may not let you enter a comma, but you can work around this by saving the number as a contact. I tested this with my network carrier, Fido, but your mileage may vary. Cover photo by Akshay Verma.",
  "image": "https://saket.me/wp-content/uploads/2019/07/simple_cover_700.jpg",
  "html": "\u003cdiv id=\"readability-page-1\" class=\"page\"\u003e\u003cdiv\u003e\n\n\t\t\t\t\u003cp\u003eWhile working on a healthcare app called \u003ca href=\"https://simple.org\" target=\"_blank\" rel=\"noopener noreferrer\"\u003eSimple\u003c/a\u003e at my previous company, we wanted to improve how nurses follow up with their patients. The aim was to replace traditional paper registers + landline phones with the app, which could intelligently suggest patients who are potentially at risk based on their medical history, age, and other important cues.\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://www.simple.org/screens/\" target=\"_blank\" rel=\"noopener noreferrer\"\u003e\u003cimg data-attachment-id=\"1200\" data-permalink=\"https://saket.me/dtmf-tones/simple/\" data-orig-file=\"https://saket.me/wp-content/uploads/2019/07/simple.png\" data-orig-size=\"3842,1708\" data-comments-opened=\"0\" data-image-meta=\"{\u0026#34;aperture\u0026#34;:\u0026#34;0\u0026#34;,\u0026#34;credit\u0026#34;:\u0026#34;\u0026#34;,\u0026#34;camera\u0026#34;:\u0026#34;\u0026#34;,\u0026#34;caption\u0026#34;:\u0026#34;\u0026#34;,\u0026#34;created_timestamp\u0026#34;:\u0026#34;0\u0026#34;,\u0026#34;copyright\u0026#34;:\u0026#34;\u0026#34;,\u0026#34;focal_length\u0026#34;:\u0026#34;0\u0026#34;,\u0026#34;iso\u0026#34;:\u0026#34;0\u0026#34;,\u0026#34;shutter_speed\u0026#34;:\u0026#34;0\u0026#34;,\u0026#34;title\u0026#34;:\u0026#34;\u0026#34;,\u0026#34;orientation\u0026#34;:\u0026#34;0\u0026#34;}\" data-image-title=\"Simple app\" data-image-description=\"\" data-medium-file=\"https://saket.me/wp-content/uploads/2019/07/simple-300x133.png\" data-large-file=\"https://saket.me/wp-content/uploads/2019/07/simple-1024x455.png\" decoding=\"async\" loading=\"lazy\" src=\"https://saket.me/wp-content/uploads/2019/07/simple.png\" alt=\"\" width=\"3842\" height=\"1708\" srcset=\"https://saket.me/wp-content/uploads/2019/07/simple.png 3842w, https://saket.me/wp-content/uploads/2019/07/simple-300x133.png 300w, https://saket.me/wp-content/uploads/2019/07/simple-768x341.png 768w, https://saket.me/wp-content/uploads/2019/07/simple-1024x455.png 1024w, https://saket.me/wp-content/uploads/2019/07/simple-1200x533.png 1200w, https://saket.me/wp-content/uploads/2019/07/simple-600x267.png 600w\" sizes=\"(max-width: 3842px) 100vw, 3842px\"/\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eFor protecting their privacy, we needed to route their phone calls through a proxy so that their personal numbers stayed hidden from their patients. This is referred to as “phone number masking” and is commonly used these days. When you take a ride with \u003ca href=\"https://uber.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003eUber\u003c/a\u003e, or order food with \u003ca href=\"https://www.zomato.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003eZomato\u003c/a\u003e, both you and your driver/rider are assigned temporary numbers for privacy for the duration of the trip/task. When your driver dials your proxy number, Uber forwards the call to your actual phone number.\u003c/p\u003e\n\u003cp\u003eThe plan was similar for Simple, but there was one problem with this approach: talking to the server required an internet connection. We wanted to keep Simple offline-first. While it’s nice to have a data connection, it was important for the app’s functionality to not degrade when a connection is unavailable, especially in remote villages.\u003c/p\u003e\n\u003cp\u003eWe needed a way to send data to our server without an internet connection. A team member came up with this fantastic idea of using DTMF tones!\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://genave.com/dtmf/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003eDTMF\u003c/a\u003e stands for Dual Tone – Multi Frequency. It’s the tone your phone plays when you press a number on the dial-pad during an ongoing phone call. Each number is assigned a combination of two sine waves for identifying its row and column indices on the dial-pad.\u003c/p\u003e\n\u003cp\u003eTurns out, DTMF tones are great. They are easy to implement and most communication-as-a-service platforms support them out of the box. On Android, DTMF tones can be played using a call Intent:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e\u0026lt;span class=\u0026#34;token keyword\u0026#34;\u0026gt;val\u0026lt;/span\u0026gt; dtmfTones \u0026lt;span class=\u0026#34;token operator\u0026#34;\u0026gt;=\u0026lt;/span\u0026gt; patientNumber \u0026lt;span class=\u0026#34;token operator\u0026#34;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026#34;token string\u0026#34;\u0026gt;\u0026#34;#\u0026#34;\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026#34;token keyword\u0026#34;\u0026gt;val\u0026lt;/span\u0026gt; numberToCall \u0026lt;span class=\u0026#34;token operator\u0026#34;\u0026gt;=\u0026lt;/span\u0026gt; tollFreeNumber \u0026lt;span class=\u0026#34;token operator\u0026#34;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026#34;token string\u0026#34;\u0026gt;\u0026#34;,\u0026#34;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026#34;token operator\u0026#34;\u0026gt;+\u0026lt;/span\u0026gt; dtmfTones\n\n\u0026lt;span class=\u0026#34;token keyword\u0026#34;\u0026gt;val\u0026lt;/span\u0026gt; numberUri \u0026lt;span class=\u0026#34;token operator\u0026#34;\u0026gt;=\u0026lt;/span\u0026gt; Uri\u0026lt;span class=\u0026#34;token punctuation\u0026#34;\u0026gt;.\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026#34;token function\u0026#34;\u0026gt;fromParts\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026#34;token punctuation\u0026#34;\u0026gt;(\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026#34;token string\u0026#34;\u0026gt;\u0026#34;tel\u0026#34;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026#34;token punctuation\u0026#34;\u0026gt;,\u0026lt;/span\u0026gt; phoneNumber\u0026lt;span class=\u0026#34;token punctuation\u0026#34;\u0026gt;,\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026#34;token keyword\u0026#34;\u0026gt;null\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026#34;token punctuation\u0026#34;\u0026gt;)\u0026lt;/span\u0026gt;\ncontext\u0026lt;span class=\u0026#34;token punctuation\u0026#34;\u0026gt;.\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026#34;token function\u0026#34;\u0026gt;startActivity\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026#34;token punctuation\u0026#34;\u0026gt;(\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026#34;token function\u0026#34;\u0026gt;Intent\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026#34;token punctuation\u0026#34;\u0026gt;(\u0026lt;/span\u0026gt;Intent\u0026lt;span class=\u0026#34;token punctuation\u0026#34;\u0026gt;.\u0026lt;/span\u0026gt;ACTION_CALL\u0026lt;span class=\u0026#34;token punctuation\u0026#34;\u0026gt;,\u0026lt;/span\u0026gt; numberUri\u0026lt;span class=\u0026#34;token punctuation\u0026#34;\u0026gt;)\u0026lt;/span\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eWhen a nurse clicks a patient’s call button, the app dials our toll-free number and plays the patient’s number as DTMF tones. The server receives the patient’s number through \u003ca href=\"https://twilio.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003eTwilio\u003c/a\u003e (which does the job of decoding DTMF tones) and in turn, connects the nurse with the intended patient.\u003c/p\u003e\n\u003cp\u003eHere’s what the call sounds like:\u003c/p\u003e\n\u003cp\u003e\u003caudio preload=\"auto\" controls=\"controls\"\u003e\u003csource src=\"https://saket.me/wp-content/uploads/2019/08/dtmf-tones-sample.m4a\" type=\"audio/mpeg\"/\u003e(If you’re seeing this text, it probably means that your browser does not support HTML5 audio.)\u003c/audio\u003e\u003c/p\u003e\n\u003cp\u003eIt would have been nice if we could customize how DTMF tones are encoded because playing a phone number takes quite long, but it’s alright considering they’ll only be used when an internet connection is unavailable.\u003c/p\u003e\n\u003cp\u003eBy now you’ve probably realized why this technology feels so familiar.\u003c/p\u003e\n\u003cp\u003e\u003cimg data-attachment-id=\"1194\" data-permalink=\"https://saket.me/dtmf-tones/dial-up-connection-in-windows-xp/\" data-orig-file=\"https://saket.me/wp-content/uploads/2019/07/dial-up-connection-in-windows-xp.jpg\" data-orig-size=\"348,429\" data-comments-opened=\"0\" data-image-meta=\"{\u0026#34;aperture\u0026#34;:\u0026#34;0\u0026#34;,\u0026#34;credit\u0026#34;:\u0026#34;\u0026#34;,\u0026#34;camera\u0026#34;:\u0026#34;\u0026#34;,\u0026#34;caption\u0026#34;:\u0026#34;\u0026#34;,\u0026#34;created_timestamp\u0026#34;:\u0026#34;0\u0026#34;,\u0026#34;copyright\u0026#34;:\u0026#34;\u0026#34;,\u0026#34;focal_length\u0026#34;:\u0026#34;0\u0026#34;,\u0026#34;iso\u0026#34;:\u0026#34;0\u0026#34;,\u0026#34;shutter_speed\u0026#34;:\u0026#34;0\u0026#34;,\u0026#34;title\u0026#34;:\u0026#34;\u0026#34;,\u0026#34;orientation\u0026#34;:\u0026#34;0\u0026#34;}\" data-image-title=\"dial-up connection in windows xp\" data-image-description=\"\" data-medium-file=\"https://saket.me/wp-content/uploads/2019/07/dial-up-connection-in-windows-xp-243x300.jpg\" data-large-file=\"https://saket.me/wp-content/uploads/2019/07/dial-up-connection-in-windows-xp.jpg\" decoding=\"async\" loading=\"lazy\" src=\"https://saket.me/wp-content/uploads/2019/07/dial-up-connection-in-windows-xp.jpg\" alt=\"Dial-up connection window in Microsoft Windows XP\" width=\"348\" height=\"429\" srcset=\"https://saket.me/wp-content/uploads/2019/07/dial-up-connection-in-windows-xp.jpg 348w, https://saket.me/wp-content/uploads/2019/07/dial-up-connection-in-windows-xp-243x300.jpg 243w\" sizes=\"(max-width: 348px) 100vw, 348px\"/\u003e\u003c/p\u003e\n\u003cp\u003eIf you’re still not convinced that DTMF tones are cool then let me introduce you to “phone phreaking”: \u003ca href=\"https://fivethirtyeight.com/features/before-they-created-apple-jobs-and-wozniak-hacked-the-phone-system/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003eBefore They Created Apple, Jobs And Wozniak Hacked The Phone System | FiveThirtyEight\u003c/a\u003e.\u003c/p\u003e\n\u003ch5\u003eExercise for the reader\u003c/h5\u003e\n\u003cp\u003eIf \u003ccode\u003e1800-XXX-XXXX\u003c/code\u003e is your network company’s customer support number and \u003ccode\u003e9\u003c/code\u003e is the number you press on the dialpad after hearing a recorded message for 20s to reach a human, what happens if you dial \u003ccode\u003e1800-XXX-XXXX,9\u003c/code\u003e directly? The dialer may not let you enter a comma, but you can work around this by \u003ca href=\"https://saket.me/wp-content/uploads/2019/07/contacts-app.png\" target=\"_blank\" rel=\"noopener noreferrer\"\u003esaving the number as a contact\u003c/a\u003e. I tested this with my network carrier, Fido, but your mileage may vary.\u003c/p\u003e\n\u003cp\u003e\u003cem\u003eCover photo by \u003ca href=\"https://twitter.com/akshayverma1\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003eAkshay Verma\u003c/a\u003e.\u003c/em\u003e\u003c/p\u003e\n\n\t\t\t\u003c/div\u003e\u003c/div\u003e",
  "readingTime": "5 min read",
  "publishedTime": "2019-08-18T00:55:04Z",
  "modifiedTime": "2019-12-18T23:42:12Z"
}
