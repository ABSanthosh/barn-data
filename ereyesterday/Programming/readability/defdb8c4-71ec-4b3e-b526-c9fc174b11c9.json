{
  "id": "defdb8c4-71ec-4b3e-b526-c9fc174b11c9",
  "title": "Provision group runners with Google Cloud Platform and GitLab CI",
  "link": "https://about.gitlab.com/blog/2024/11/19/provision-group-runners-with-google-cloud-platform-and-gitlab-ci",
  "description": "",
  "author": "Noah Ing",
  "published": "2024-11-19T00:00:00.000Z",
  "source": "https://about.gitlab.com/atom.xml",
  "categories": null,
  "byline": "Noah Ing, Sarah Matthies",
  "length": 3033,
  "excerpt": "This tutorial will teach you how to set up a new group runner on GitLab.com using Google Cloud Platform in less than 10 minutes.",
  "siteName": "GitLab",
  "favicon": "https://about.gitlab.com/blog/nuxt-images/ico/favicon-192x192.png?cache=2022041",
  "text": "Are you interested in hosting your own servers to run your GitLab CI/CD pipelines but don’t know where to begin? Setting up a GitLab Runner to run your pipelines on your own infrastructure can seem like a daunting task as it requires infrastructure knowledge and the know-how to maintain that infrastructure. Typically this process requires the provision of infrastructure, the installing of dependency, and testing that it works with your GitLab instance. This article highlights how easy it is to easily spin up a GitLab Runner of your own utilizing GitLab’s Google Cloud Integration. Follow this tutorial and it will teach you how to set up a new group runner on GitLab.com using Google Cloud Platform in less than 10 minutes! You will learn how to: Create a new group runner. Configure the new group runner’s tags and description. Register the new group runner by adding in configurations. Provision the GitLab Runner utilizing gcloud cli and Terraform. Have your GitLab Runner pick up its first GitLab CI job. Prerequisites A terminal with Bash installed Owner access on a Google Cloud Platform project Terraform (or OpenTofu) Version 1.5 or greater gcloud CLI 10 minutes Tutorial Create a new group runner under Build \u003e Runners \u003e New Group Runner. Note: Navigate to the group level. Configure the new group runner's tags, description, and any additional configurations. Select Google Cloud. Copy your project ID from Google Cloud Platform. Fill out your Google Cloud project ID and choose a region, zone, and type of machine you want to use. 6. Once this information is filled out, click Setup instructions. Run the bash script provided in Step 1 above. Note: This script was saved to a file called setup.sh for ease of use. You may copy this right into your terminal if you are confident in debugging. 7. Create a main.tf file and follow the instructions in GitLab. Note: If you want to use OpenTofu instead of Terraform, you can still copy the code and only have to adjust the Terraform commands for applying the configuration. Once successfully provisioned, you should be see the following: 8. If you close the instructions and click the View runners button, you will now have a newly provisioned runner present with \"Never contacted\" as its status. 9. In any project, add the following .gitlab-ci.yml. stages: - greet hello_job: stage: greet tags: - gcp-runner script: - echo \"hello\" Volia! You have set up your first GitLab Runner utilizing Google Cloud Platform. Next steps Now that you have provisioned your very own GitLab Runner, consider optimizing it for your specific use case. Some things to consider with your runner moving forward: Is the runner I provisioned the right size? Does it need additional resources for my use case? Does the GitLab Runner contain all the dependency my builds need? How can I store the GitLab Runner as infrastructure as code? Make sure to bookmark the Provisioning runners in Google Cloud documentation for easy reference.",
  "image": "https://images.ctfassets.net/r9o86ar0p03f/4E5Fx1Q0DHikigzCsQWhOG/6a537598474388e449bf7b7ad6466f2a/AdobeStock_623844718.jpeg?fm=webp\u0026w=820\u0026h=500",
  "html": "\u003cdiv id=\"readability-page-1\" class=\"page\"\u003e\u003cdiv data-v-af247218=\"\" data-v-7488832a=\"\" data-v-74bd29c6=\"\"\u003e\u003cp\u003eAre you interested in hosting your own servers to run your GitLab CI/CD pipelines but don’t know where to begin? Setting up a GitLab Runner to run your pipelines on your own infrastructure can seem like a daunting task as it requires infrastructure knowledge and the know-how to maintain that infrastructure. Typically this process requires the provision of infrastructure, the installing of dependency, and testing that it works with your GitLab instance.\u003c/p\u003e\n\u003cp\u003eThis article highlights how easy it is to easily spin up a GitLab Runner of your own utilizing GitLab’s Google Cloud Integration. Follow this tutorial and it will teach you how to set up a new group runner on GitLab.com using Google Cloud Platform in less than 10 minutes!\u003c/p\u003e\n\u003cp\u003eYou will learn how to:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eCreate a new group runner.\u003c/li\u003e\n\u003cli\u003eConfigure the new group runner’s tags and description.\u003c/li\u003e\n\u003cli\u003eRegister the new group runner by adding in configurations.\u003c/li\u003e\n\u003cli\u003eProvision the GitLab Runner utilizing \u003ccode\u003egcloud cli\u003c/code\u003e and Terraform.\u003c/li\u003e\n\u003cli\u003eHave your GitLab Runner pick up its first GitLab CI job.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"prerequisites\" tabindex=\"-1\"\u003ePrerequisites \u003ca href=\"#prerequisites\"\u003e\u003csvg width=\"24\" height=\"24\" viewBox=\"0 0 16 16\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\"\u003e\u003cpath d=\"M12.2426 3.75736C11.4615 2.97631 10.1952 2.97631 9.41416 3.75736L7.99995 5.17157C7.60942 5.56209 6.97626 5.56209 6.58573 5.17157C6.19521 4.78105 6.19521 4.14788 6.58573 3.75736L7.99995 2.34314C9.56205 0.781046 12.0947 0.781046 13.6568 2.34314C15.2189 3.90524 15.2189 6.4379 13.6568 8L12.2426 9.41421C11.8521 9.80473 11.2189 9.80473 10.8284 9.41421C10.4379 9.02369 10.4379 8.39052 10.8284 8L12.2426 6.58578C13.0236 5.80473 13.0236 4.5384 12.2426 3.75736Z\" fill=\"#333333\"\u003e\u003c/path\u003e\u003cpath d=\"M10.5355 5.4645C10.926 5.85502 10.926 6.48819 10.5355 6.87871L6.87863 10.5356C6.4881 10.9261 5.85494 10.9261 5.46441 10.5356C5.07389 10.145 5.07389 9.51188 5.46441 9.12135L9.12127 5.4645C9.51179 5.07397 10.145 5.07397 10.5355 5.4645Z\" fill=\"#333333\"\u003e\u003c/path\u003e\u003cpath d=\"M3.75742 9.41422C2.97637 10.1953 2.97637 11.4616 3.75742 12.2426C4.53847 13.0237 5.8048 13.0237 6.58584 12.2426L8.00006 10.8284C8.39058 10.4379 9.02375 10.4379 9.41427 10.8284C9.8048 11.219 9.8048 11.8521 9.41427 12.2426L8.00006 13.6569C6.43796 15.219 3.9053 15.219 2.3432 13.6569C0.781107 12.0948 0.781107 9.56211 2.3432 8.00001L3.75742 6.5858C4.14794 6.19527 4.78111 6.19527 5.17163 6.5858C5.56216 6.97632 5.56215 7.60948 5.17163 8.00001L3.75742 9.41422Z\" fill=\"#333333\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eA terminal with Bash installed\u003c/li\u003e\n\u003cli\u003eOwner access on a Google Cloud Platform project\u003c/li\u003e\n\u003cli\u003eTerraform (or OpenTofu) \u003ca href=\"https://releases.hashicorp.com/terraform/1.5.7/\"\u003eVersion 1.5\u003c/a\u003e or greater\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://cloud.google.com/sdk/docs/install\"\u003egcloud CLI\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e10 minutes\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"tutorial\" tabindex=\"-1\"\u003eTutorial \u003ca href=\"#tutorial\"\u003e\u003csvg width=\"24\" height=\"24\" viewBox=\"0 0 16 16\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\"\u003e\u003cpath d=\"M12.2426 3.75736C11.4615 2.97631 10.1952 2.97631 9.41416 3.75736L7.99995 5.17157C7.60942 5.56209 6.97626 5.56209 6.58573 5.17157C6.19521 4.78105 6.19521 4.14788 6.58573 3.75736L7.99995 2.34314C9.56205 0.781046 12.0947 0.781046 13.6568 2.34314C15.2189 3.90524 15.2189 6.4379 13.6568 8L12.2426 9.41421C11.8521 9.80473 11.2189 9.80473 10.8284 9.41421C10.4379 9.02369 10.4379 8.39052 10.8284 8L12.2426 6.58578C13.0236 5.80473 13.0236 4.5384 12.2426 3.75736Z\" fill=\"#333333\"\u003e\u003c/path\u003e\u003cpath d=\"M10.5355 5.4645C10.926 5.85502 10.926 6.48819 10.5355 6.87871L6.87863 10.5356C6.4881 10.9261 5.85494 10.9261 5.46441 10.5356C5.07389 10.145 5.07389 9.51188 5.46441 9.12135L9.12127 5.4645C9.51179 5.07397 10.145 5.07397 10.5355 5.4645Z\" fill=\"#333333\"\u003e\u003c/path\u003e\u003cpath d=\"M3.75742 9.41422C2.97637 10.1953 2.97637 11.4616 3.75742 12.2426C4.53847 13.0237 5.8048 13.0237 6.58584 12.2426L8.00006 10.8284C8.39058 10.4379 9.02375 10.4379 9.41427 10.8284C9.8048 11.219 9.8048 11.8521 9.41427 12.2426L8.00006 13.6569C6.43796 15.219 3.9053 15.219 2.3432 13.6569C0.781107 12.0948 0.781107 9.56211 2.3432 8.00001L3.75742 6.5858C4.14794 6.19527 4.78111 6.19527 5.17163 6.5858C5.56216 6.97632 5.56215 7.60948 5.17163 8.00001L3.75742 9.41422Z\" fill=\"#333333\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003col\u003e\n\u003cli\u003eCreate a new group runner under \u003cstrong\u003eBuild \u0026gt; Runners \u0026gt; New Group Runner\u003c/strong\u003e.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003e\u003cstrong\u003eNote:\u003c/strong\u003e Navigate to the group level.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://images.ctfassets.net/r9o86ar0p03f/6MQ8Y7SGvcuEkk3JEBk0dM/b56bce4f67e5bae1aba5f418fbabf8ef/image7.png\" alt=\"GitLab Runner setup screen\"/\u003e\u003c/p\u003e\n\u003col start=\"2\"\u003e\n\u003cli\u003eConfigure the new group runner\u0026#39;s tags, description, and any additional configurations.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003e\u003cimg src=\"https://images.ctfassets.net/r9o86ar0p03f/22D3HmrsadXQomRKlDKkXf/f4b45e61689a79646e1dfed221baff96/image4.png\" alt=\"New Group Runner setup\"/\u003e\u003c/p\u003e\n\u003col start=\"3\"\u003e\n\u003cli\u003eSelect \u003cstrong\u003eGoogle Cloud\u003c/strong\u003e.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003e\u003cimg src=\"https://images.ctfassets.net/r9o86ar0p03f/4SSJyPrVbIVELAbIwh0rr4/b7df184cf8baeaaccb9da9d392882730/image3.png\" alt=\"Select Google Cloud screen\"/\u003e\u003c/p\u003e\n\u003col start=\"4\"\u003e\n\u003cli\u003eCopy your project ID from Google Cloud Platform.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003e\u003cimg src=\"https://images.ctfassets.net/r9o86ar0p03f/71XQlDxHhZDs6MO1IyUVBv/c71ab73afbe51053b7688852594189ca/image1.png\" alt=\"Copy project ID from GCP screen\"/\u003e\u003c/p\u003e\n\u003col start=\"5\"\u003e\n\u003cli\u003eFill out your Google Cloud project ID and choose a region, zone, and type of machine you want to use.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003e\u003cimg src=\"https://images.ctfassets.net/r9o86ar0p03f/lJAyU35ErIygD4iobRPbm/7d40d9f70fe85de95a2ab133dbfddd70/image8.png\" alt=\"Screen to fill out Google Cloud information\"/\u003e\u003c/p\u003e\n\u003cp\u003e6. Once this information is filled out, click \u003cstrong\u003eSetup instructions\u003c/strong\u003e.\u003c/p\u003e\n\u003cp\u003eRun the bash script provided in Step 1 above.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eNote:\u003c/strong\u003e This script was saved to a file called \u003ccode\u003esetup.sh\u003c/code\u003e for ease of use. You may copy this right into your terminal if you are confident in debugging.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://images.ctfassets.net/r9o86ar0p03f/1L1KmMrgYrBRFOkW9OUchE/214948b134aef59abcd1d2da20b930e6/image6.png\" alt=\"Setup instructions screen\"/\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://images.ctfassets.net/r9o86ar0p03f/4OWNU5AvDJ9ndUdqnj1cq6/2aefa2d94a27a56337d7a9889e1d807c/image10.png\" alt=\"Script for GitLab Runner\"/\u003e\u003c/p\u003e\n\u003cp\u003e7. Create a \u003ccode\u003emain.tf\u003c/code\u003e file and follow the instructions in GitLab.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eNote:\u003c/strong\u003e If you want to use OpenTofu instead of Terraform, you can still copy the code and only have to adjust the Terraform commands for applying the configuration.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://images.ctfassets.net/r9o86ar0p03f/4HWvLdJyk1vLdd9xOe31Sl/8cd858370a56ab619d32f3dd0005be98/image9.png\" alt=\"Install and register GitLab Runner screen\"/\u003e\u003c/p\u003e\n\u003cp\u003eOnce successfully provisioned, you should be see the following:\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://images.ctfassets.net/r9o86ar0p03f/7MBpCVd0qGCPA5kioiAN3D/9eeb4cca6f0011a365c1a5ad83855361/image5.png\" alt=\"GitLab Runner code\"/\u003e\u003c/p\u003e\n\u003cp\u003e8. If you close the instructions and click the \u003cstrong\u003eView runners\u003c/strong\u003e button, you will now have a newly provisioned runner present with \u0026#34;Never contacted\u0026#34; as its status.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://images.ctfassets.net/r9o86ar0p03f/61c82gdSBlJTwJ5FOZb8Q/700346027ba1f08f9e15cd74baa7bffc/image2.png\" alt=\"Newly provisioned runner on screen\"/\u003e\u003c/p\u003e\n\u003cp\u003e9. In any project, add the following \u003ccode\u003e.gitlab-ci.yml\u003c/code\u003e.\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003estages:  \n  - greet\n\nhello_job:  \n  stage: greet  \n  tags:  \n    - gcp-runner  \n  script:  \n    - echo \u0026#34;hello\u0026#34;  \n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eVolia! You have set up your first GitLab Runner utilizing Google Cloud Platform.\u003c/p\u003e\n\u003ch2 id=\"next-steps\" tabindex=\"-1\"\u003eNext steps \u003ca href=\"#next-steps\"\u003e\u003csvg width=\"24\" height=\"24\" viewBox=\"0 0 16 16\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\"\u003e\u003cpath d=\"M12.2426 3.75736C11.4615 2.97631 10.1952 2.97631 9.41416 3.75736L7.99995 5.17157C7.60942 5.56209 6.97626 5.56209 6.58573 5.17157C6.19521 4.78105 6.19521 4.14788 6.58573 3.75736L7.99995 2.34314C9.56205 0.781046 12.0947 0.781046 13.6568 2.34314C15.2189 3.90524 15.2189 6.4379 13.6568 8L12.2426 9.41421C11.8521 9.80473 11.2189 9.80473 10.8284 9.41421C10.4379 9.02369 10.4379 8.39052 10.8284 8L12.2426 6.58578C13.0236 5.80473 13.0236 4.5384 12.2426 3.75736Z\" fill=\"#333333\"\u003e\u003c/path\u003e\u003cpath d=\"M10.5355 5.4645C10.926 5.85502 10.926 6.48819 10.5355 6.87871L6.87863 10.5356C6.4881 10.9261 5.85494 10.9261 5.46441 10.5356C5.07389 10.145 5.07389 9.51188 5.46441 9.12135L9.12127 5.4645C9.51179 5.07397 10.145 5.07397 10.5355 5.4645Z\" fill=\"#333333\"\u003e\u003c/path\u003e\u003cpath d=\"M3.75742 9.41422C2.97637 10.1953 2.97637 11.4616 3.75742 12.2426C4.53847 13.0237 5.8048 13.0237 6.58584 12.2426L8.00006 10.8284C8.39058 10.4379 9.02375 10.4379 9.41427 10.8284C9.8048 11.219 9.8048 11.8521 9.41427 12.2426L8.00006 13.6569C6.43796 15.219 3.9053 15.219 2.3432 13.6569C0.781107 12.0948 0.781107 9.56211 2.3432 8.00001L3.75742 6.5858C4.14794 6.19527 4.78111 6.19527 5.17163 6.5858C5.56216 6.97632 5.56215 7.60948 5.17163 8.00001L3.75742 9.41422Z\" fill=\"#333333\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003eNow that you have provisioned your very own GitLab Runner, consider optimizing it for your specific use case. Some things to consider with your runner moving forward:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eIs the runner I provisioned the right size? Does it need additional resources for my use case?\u003c/li\u003e\n\u003cli\u003eDoes the GitLab Runner contain all the dependency my builds need?\u003c/li\u003e\n\u003cli\u003eHow can I store the GitLab Runner as infrastructure as code?\u003c/li\u003e\n\u003c/ul\u003e\n\u003cblockquote\u003e\n\u003cp\u003eMake sure to bookmark the \u003ca href=\"https://docs.gitlab.com/ee/ci/runners/provision_runners_google_cloud.html\"\u003eProvisioning runners in Google Cloud documentation\u003c/a\u003e for easy reference.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003c/div\u003e\u003c/div\u003e",
  "readingTime": "4 min read",
  "publishedTime": "2024-11-19T00:00:00Z",
  "modifiedTime": null
}
