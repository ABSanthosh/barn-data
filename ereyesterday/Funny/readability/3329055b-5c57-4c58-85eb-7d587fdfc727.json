{
  "id": "3329055b-5c57-4c58-85eb-7d587fdfc727",
  "title": "CodeSOD: Message Oriented Database",
  "link": "https://thedailywtf.com/articles/message-oriented-database",
  "description": "Mark was debugging some database querying code, and got a bit confused about what it was actually doing. Specifically, it generated a query block like this: $statement=\"declare @status int declare @msg varchar(30) exec @status=sp_doSomething 'arg1', ... select @msg=convert(varchar(10),@status) print @msg \"; $result = sybase_query ($statement, $this-\u003econnection); Run a stored procedure, capture its return value in a variable, stringify that variable and print it. The select/print must be for debugging, right? Leftover debugging code. Why else would you do something like that? if (sybase_get_last_message()!=='0') { ... } Oh no. sybase_get_last_message gets the last string printed out by a print statement. This is a pretty bonkers way to get the results of a function or procedure call back, especially when if there are any results (like a return value), they'll be in the $result return value. Now that said, reading through those functions, it's a little unclear if you can actually get the return value of a stored procedure this way. Without testing it myself (and no, I'm not doing that), we're in a world where this might actually be the best way to do this. So I'm not 100% sure where the WTF lies. In the developer? In the API designers? Sybase being TRWTF is always a pretty reliable bet. I suppose there's a reason why all those functions are listed as \"REMOVED IN PHP 7.0.0\", which was was rolled out through 2015. So at least those functions have been dead for a decade. [Advertisement] Keep the plebs out of prod. Restrict NuGet feed privileges with ProGet. Learn more.",
  "author": "Remy Porter",
  "published": "Tue, 15 Apr 2025 06:30:00 GMT",
  "source": "http://syndication.thedailywtf.com/TheDailyWtf",
  "categories": [
    "CodeSOD"
  ],
  "byline": "Remy Porter",
  "length": 1897,
  "excerpt": "Mark was debugging some database querying code, and got a bit confused about what it was actually doing. Specifically, it generated a query block like this: $statement=\"declare @status int declare @msg varchar(30) exec @status=sp_doSomething 'arg1', ... select @msg=convert(varchar(10),@status) print @msg \"; $result = sybase_query ($statement, $this-\u003econnection);",
  "siteName": "The Daily WTF",
  "favicon": "",
  "text": "by in CodeSOD on 2025-04-15 Edit Remy PorterComputers were a mistake, which is why I'm trying to shoot them into space. Editor-in-Chief for TDWTF. Mark was debugging some database querying code, and got a bit confused about what it was actually doing. Specifically, it generated a query block like this: $statement=\"declare @status int declare @msg varchar(30) exec @status=sp_doSomething 'arg1', ... select @msg=convert(varchar(10),@status) print @msg \"; $result = sybase_query ($statement, $this-\u003econnection); Run a stored procedure, capture its return value in a variable, stringify that variable and print it. The select/print must be for debugging, right? Leftover debugging code. Why else would you do something like that? if (sybase_get_last_message()!=='0') { ... } Oh no. sybase_get_last_message gets the last string printed out by a print statement. This is a pretty bonkers way to get the results of a function or procedure call back, especially when if there are any results (like a return value), they'll be in the $result return value. Now that said, reading through those functions, it's a little unclear if you can actually get the return value of a stored procedure this way. Without testing it myself (and no, I'm not doing that), we're in a world where this might actually be the best way to do this. So I'm not 100% sure where the WTF lies. In the developer? In the API designers? Sybase being TRWTF is always a pretty reliable bet. I suppose there's a reason why all those functions are listed as \"REMOVED IN PHP 7.0.0\", which was was rolled out through 2015. So at least those functions have been dead for a decade. [Advertisement] Keep the plebs out of prod. Restrict NuGet feed privileges with ProGet. Learn more.",
  "image": "https://s3.amazonaws.com/remy.jetpackshark.com/remy-thumb.jpg",
  "html": "\u003cdiv id=\"readability-page-1\" class=\"page\"\u003e\u003cdiv itemscope=\"\" itemtype=\"http://schema.org/Article\" id=\"article-page\"\u003e\n\n        \n        \u003cp\u003e\u003cspan\u003eby \n            in \u003ca itemprop=\"articleSection\" href=\"https://thedailywtf.com/series/code-sod\"\u003eCodeSOD\u003c/a\u003e\n            on \u003cspan itemprop=\"datePublished\" content=\"2025-04-15\"\u003e2025-04-15\u003c/span\u003e\n            \u003ca href=\"https://thedailywtf.com/admin/article/edit/10892\" rel=\"nofollow\"\u003eEdit\u003c/a\u003e\n        \u003c/span\u003e\u003c/p\u003e\n        \u003cdiv itemprop=\"author\" itemscope=\"\" itemtype=\"http://schema.org/Person\"\u003e\n            \u003cp\u003e\u003cimg itemprop=\"image\" src=\"https://s3.amazonaws.com/remy.jetpackshark.com/remy-thumb.jpg\"/\u003e\n            \u003ca itemprop=\"name\" href=\"https://thedailywtf.com/authors/remy-porter\"\u003eRemy Porter\u003c/a\u003e\u003c/p\u003e\u003cp itemprop=\"description\"\u003eComputers were a mistake, which is why I\u0026#39;m trying to shoot them into space. Editor-in-Chief for TDWTF.\u003c/p\u003e\n        \u003c/div\u003e\n        \u003cdiv itemprop=\"articleBody\"\u003e\n            \u003cp\u003e\u003cstrong\u003eMark\u003c/strong\u003e was debugging some database querying code, and got a bit confused about what it was actually doing. Specifically, it generated a query block like this:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e\u003cspan\u003e$statement\u003c/span\u003e=\u003cspan\u003e\u0026#34;declare @status int\n        declare @msg varchar(30)\n        exec @status=sp_doSomething \u0026#39;arg1\u0026#39;, ...\n        select @msg=convert(varchar(10),@status)\n        print @msg\n        \u0026#34;\u003c/span\u003e;\n\n\u003cspan\u003e$result\u003c/span\u003e = \u003cspan\u003esybase_query\u003c/span\u003e (\u003cspan\u003e$statement\u003c/span\u003e, \u003cspan\u003e$this\u003c/span\u003e-\u0026gt;connection);\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eRun a stored procedure, capture its return value in a variable, stringify that variable and print it. The \u003ccode\u003eselect\u003c/code\u003e/\u003ccode\u003eprint\u003c/code\u003e must be for debugging, right? Leftover debugging code. Why else would you do something like that?\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e\u003cspan\u003eif\u003c/span\u003e (\u003cspan\u003esybase_get_last_message\u003c/span\u003e()!==\u003cspan\u003e\u0026#39;0\u0026#39;\u003c/span\u003e) {\n    ...\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eOh no. \u003ccode\u003esybase_get_last_message\u003c/code\u003e gets the last string printed out by a print statement. This is a pretty bonkers way to get the results of a function or procedure call back, especially when if there are any results (like a return value), \u003ca href=\"https://phpdoctest.github.io/en/function.sybase-query.html\"\u003ethey\u0026#39;ll be in the $result\u003c/a\u003e return value.\u003c/p\u003e\n\u003cp\u003eNow that said, reading through those functions, it\u0026#39;s a little unclear if you can actually get the return value of a stored procedure this way. Without testing it myself (and no, I\u0026#39;m not doing that), we\u0026#39;re in a world where \u003cem\u003ethis might actually be the best way to do this\u003c/em\u003e.\u003c/p\u003e\n\u003cp\u003eSo I\u0026#39;m not 100% sure where the WTF lies. In the developer? In the API designers? Sybase being TRWTF is always a pretty reliable bet. I suppose there\u0026#39;s a reason why all those functions are listed as \u0026#34;REMOVED IN PHP 7.0.0\u0026#34;, which was was rolled out through 2015. So at least those functions have been dead for a decade.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://thedailywtf.com/images/inedo/proget-icon.png\"/\u003e [Advertisement] \n\tKeep the plebs out of prod. Restrict NuGet feed privileges with ProGet. \u003ca href=\"https://inedo.com/proget/private-nuget-server?utm_source=tdwtf\u0026amp;utm_medium=footer\u0026amp;utm_content=PlebsFooter\u0026amp;utm_campaign=Cyclops2020\"\u003eLearn more.\u003c/a\u003e\n\u003c/p\u003e\n\n\n        \u003c/div\u003e\n\n        \n    \u003c/div\u003e\u003c/div\u003e",
  "readingTime": "3 min read",
  "publishedTime": "2025-04-15T06:30:00Z",
  "modifiedTime": null
}
