{
  "id": "e5ef8b1a-825f-41b2-9654-250b355c93c8",
  "title": "Fine-tuning vs. in-context learning: New research guides better LLM customization for real-world tasks",
  "link": "https://venturebeat.com/ai/fine-tuning-vs-in-context-learning-new-research-guides-better-llm-customization-for-real-world-tasks/",
  "description": "By combining fine-tuning and in-context learning, you get LLMs that can learn tasks that would be too difficult or expensive for either method",
  "author": "Ben Dickson",
  "published": "Sat, 10 May 2025 00:23:09 +0000",
  "source": "https://feeds.feedburner.com/venturebeat/SZYF",
  "categories": [
    "AI",
    "Business",
    "Data Infrastructure",
    "AI research",
    "AI, ML and Deep Learning",
    "DeepMind",
    "fine tuning",
    "Google Deepmind",
    "in-context learning (ICL)",
    "large language models",
    "large language models (LLMs)",
    "LLMs",
    "research",
    "Stanford University"
  ],
  "byline": "Ben Dickson",
  "length": 7058,
  "excerpt": "By combining fine-tuning and in-context learning, you get LLMs that can learn tasks that would be too difficult or expensive for either method",
  "siteName": "VentureBeat",
  "favicon": "",
  "text": "May 9, 2025 5:23 PM Credit: VentureBeat made with Midjourney Join our daily and weekly newsletters for the latest updates and exclusive content on industry-leading AI coverage. Learn More Two popular approaches for customizing large language models (LLMs) for downstream tasks are fine-tuning and in-context learning (ICL). In a recent study, researchers at Google DeepMind and Stanford University explored the generalization capabilities of these two methods. They find that ICL has greater generalization ability (though it comes at a higher computation cost during inference). They also propose a novel approach to get the best of both worlds.  The findings can help developers make crucial decisions when building LLM applications for their bespoke enterprise data. Testing how language models learn new tricks Fine-tuning involves taking a pre-trained LLM and further training it on a smaller, specialized dataset. This adjusts the model’s internal parameters to teach it new knowledge or skills. In-context learning (ICL), on the other hand, doesn’t change the model’s underlying parameters. Instead, it guides the LLM by providing examples of the desired task directly within the input prompt. The model then uses these examples to figure out how to handle a new, similar query. The researchers set out to rigorously compare how well models generalize to new tasks using these two methods. They constructed “controlled synthetic datasets of factual knowledge” with complex, self-consistent structures, like imaginary family trees or hierarchies of fictional concepts.  To ensure they were testing the model’s ability to learn new information, they replaced all nouns, adjectives, and verbs with nonsense terms, avoiding any overlap with the data the LLMs might have encountered during pre-training.  The models were then tested on various generalization challenges. For instance, one test involved simple reversals. If a model was trained that “femp are more dangerous than glon,” could it correctly infer that “glon are less dangerous than femp”? Another test focused on simple syllogisms, a form of logical deduction. If told “All glon are yomp” and “All troff are glon,” could the model deduce that “All troff are yomp”? They also used a more complex “semantic structure benchmark” with a richer hierarchy of these made-up facts to test more nuanced understanding. “Our results are focused primarily on settings about how models generalize to deductions and reversals from fine-tuning on novel knowledge structures, with clear implications for situations when fine-tuning is used to adapt a model to company-specific and proprietary information,” Andrew Lampinen, Research Scientist at Google DeepMind and lead author of the paper, told VentureBeat. To evaluate performance, the researchers fine-tuned Gemini 1.5 Flash on these datasets. For ICL, they fed the entire training dataset (or large subsets) as context to an instruction-tuned model before posing the test questions. The results consistently showed that, in data-matched settings, ICL led to better generalization than standard fine-tuning. Models using ICL were generally better at tasks like reversing relationships or making logical deductions from the provided context. Pre-trained models, without fine-tuning or ICL, performed poorly, indicating the novelty of the test data.  “One of the main trade-offs to consider is that, whilst ICL doesn’t require fine-tuning (which saves the training costs), it is generally more computationally expensive with each use, since it requires providing additional context to the model,” Lampinen said. “On the other hand, ICL tends to generalize better for the datasets and models that we evaluated.” A hybrid approach: Augmenting fine-tuning Building on the observation that ICL excels at flexible generalization, the researchers proposed a new method to enhance fine-tuning: adding in-context inferences to fine-tuning data. The core idea is to use the LLM’s own ICL capabilities to generate more diverse and richly inferred examples, and then add these augmented examples to the dataset used for fine-tuning. They explored two main data augmentation strategies: A local strategy: This approach focuses on individual pieces of information. The LLM is prompted to rephrase single sentences from the training data or draw direct inferences from them, such as generating reversals.  A global strategy: The LLM is given the full training dataset as context, then prompted to generate inferences by linking a particular document or fact with the rest of the provided information, leading to a longer reasoning trace of relevant inferences. When the models were fine-tuned on these augmented datasets, the gains were significant. This augmented fine-tuning significantly improved generalization, outperforming not only standard fine-tuning but also plain ICL.  “For example, if one of the company documents says ‘XYZ is an internal tool for analyzing data,’ our results suggest that ICL and augmented finetuning will be more effective at enabling the model to answer related questions like ‘What internal tools for data analysis exist?’” Lampinen said. This approach offers a compelling path forward for enterprises. By investing in creating these ICL-augmented datasets, developers can build fine-tuned models that exhibit stronger generalization capabilities. This can lead to more robust and reliable LLM applications that perform better on diverse, real-world inputs without incurring the continuous inference-time costs associated with large in-context prompts.  “Augmented fine-tuning will generally make the model fine-tuning process more expensive, because it requires an additional step of ICL to augment the data, followed by fine-tuning,” Lampinen said. “Whether that additional cost is merited by the improved generalization will depend on the specific use case. However, it is computationally cheaper than applying ICL every time the model is used, when amortized over many uses of the model.” While Lampinen noted that further research is needed to see how the components they studied interact in different settings, he added that their findings indicate that developers may want to consider exploring augmented fine-tuning in cases where they see inadequate performance from fine-tuning alone.  “Ultimately, we hope this work will contribute to the science of understanding learning and generalization in foundation models, and the practicalities of adapting them to downstream tasks,” Lampinen said. Daily insights on business use cases with VB Daily If you want to impress your boss, VB Daily has you covered. We give you the inside scoop on what companies are doing with generative AI, from regulatory shifts to practical deployments, so you can share insights for maximum ROI. Read our Privacy Policy Thanks for subscribing. Check out more VB newsletters here. An error occured.",
  "image": "https://venturebeat.com/wp-content/uploads/2024/09/cfr0z3n_a_robot_in_a_collared_polo_sits_at_a_desk_dutifully_sta_1a510b62-1550-4ca9-839a-dfd64d6c304c-1.png?w=1024?w=1200\u0026strip=all",
  "html": "\u003cdiv id=\"readability-page-1\" class=\"page\"\u003e\u003cdiv\u003e\n\t\t\n\t\t\u003csection\u003e\n\t\t\t\n\t\t\t\u003cp\u003e\u003ctime title=\"2025-05-10T00:23:09+00:00\" datetime=\"2025-05-10T00:23:09+00:00\"\u003eMay 9, 2025 5:23 PM\u003c/time\u003e\n\t\t\t\u003c/p\u003e\n\t\t\t\n\t\t\u003c/section\u003e\n\t\t\u003cdiv\u003e\n\t\t\t\t\t\u003cp\u003e\u003cimg width=\"750\" height=\"420\" src=\"https://venturebeat.com/wp-content/uploads/2024/09/cfr0z3n_a_robot_in_a_collared_polo_sits_at_a_desk_dutifully_sta_1a510b62-1550-4ca9-839a-dfd64d6c304c-1.png?w=750\" alt=\"White humanoid robot stamps papers in a plush office\"/\u003e\u003c/p\u003e\u003cp\u003e\u003cspan\u003eCredit: VentureBeat made with Midjourney\u003c/span\u003e\u003c/p\u003e\t\t\u003c/div\u003e\n\t\u003c/div\u003e\u003cdiv id=\"primary\"\u003e\n\n\t\t\u003carticle id=\"content\"\u003e\n\t\t\t\u003cdiv\u003e\n\t\t\t\t\u003cdiv id=\"boilerplate_2682874\"\u003e\n\u003cp\u003e\u003cem\u003eJoin our daily and weekly newsletters for the latest updates and exclusive content on industry-leading AI coverage. \u003ca href=\"https://venturebeat.com/newsletters/?utm_source=VBsite\u0026amp;utm_medium=desktopNav\" data-type=\"link\" data-id=\"https://venturebeat.com/newsletters/?utm_source=VBsite\u0026amp;utm_medium=desktopNav\"\u003eLearn More\u003c/a\u003e\u003c/em\u003e\u003c/p\u003e\n\n\n\n\u003chr/\u003e\n\u003c/div\u003e\u003cp\u003eTwo popular approaches for customizing large language models (LLMs) for downstream tasks are fine-tuning and in-context learning (ICL). In a \u003ca href=\"https://arxiv.org/abs/2505.00661\" target=\"_blank\" rel=\"noreferrer noopener\"\u003erecent study\u003c/a\u003e, researchers at Google DeepMind and Stanford University explored the generalization capabilities of these two methods. They find that ICL has greater generalization ability (though it comes at a higher computation cost during inference). They also propose a novel approach to get the best of both worlds. \u003c/p\u003e\n\n\n\n\u003cp\u003eThe findings can help developers make crucial decisions when building LLM applications for their bespoke enterprise data.\u003c/p\u003e\n\n\n\n\u003ch2 id=\"h-testing-how-language-models-learn-new-tricks\"\u003eTesting how language models learn new tricks\u003c/h2\u003e\n\n\n\n\u003cp\u003e\u003ca href=\"https://bdtechtalks.com/2023/07/10/llm-fine-tuning/\" target=\"_blank\" rel=\"noreferrer noopener\"\u003eFine-tuning\u003c/a\u003e involves taking a pre-trained LLM and further training it on a smaller, specialized dataset. This adjusts the model’s internal parameters to teach it new knowledge or skills. \u003ca href=\"https://venturebeat.com/ai/deepmind-researchers-discover-impressive-learning-capabilities-in-long-context-llms/\"\u003eIn-context learning\u003c/a\u003e (ICL), on the other hand, doesn’t change the model’s underlying parameters. Instead, it guides the LLM by providing examples of the desired task directly within the input prompt. The model then uses these examples to figure out how to handle a new, similar query.\u003c/p\u003e\n\n\n\n\u003cp\u003eThe researchers set out to rigorously compare how well models generalize to new tasks using these two methods. They constructed “controlled synthetic datasets of factual knowledge” with complex, self-consistent structures, like imaginary family trees or hierarchies of fictional concepts. \u003c/p\u003e\n\n\n\n\u003cp\u003eTo ensure they were testing the model’s ability to learn new information, they replaced all nouns, adjectives, and verbs with nonsense terms, avoiding any overlap with the data the LLMs might have encountered during pre-training. \u003c/p\u003e\n\n\n\n\u003cp\u003eThe models were then tested on various generalization challenges. For instance, one test involved \u003cstrong\u003esimple reversals\u003c/strong\u003e. If a model was trained that “femp are more dangerous than glon,” could it correctly infer that “glon are less dangerous than femp”? Another test focused on \u003cstrong\u003esimple syllogisms\u003c/strong\u003e, a form of logical deduction. If told “All glon are yomp” and “All troff are glon,” could the model deduce that “All troff are yomp”? They also used a more complex “semantic structure benchmark” with a richer hierarchy of these made-up facts to test more nuanced understanding.\u003c/p\u003e\n\n\n\n\u003cp\u003e“Our results are focused primarily on settings about how models generalize to deductions and reversals from fine-tuning on novel knowledge structures, with clear implications for situations when fine-tuning is used to adapt a model to company-specific and proprietary information,” Andrew Lampinen, Research Scientist at Google DeepMind and lead author of the paper, told VentureBeat.\u003c/p\u003e\n\n\n\n\u003cp\u003eTo evaluate performance, the researchers fine-tuned \u003ca href=\"https://venturebeat.com/ai/google-gemini-1-5-flash-rapid-multimodal-model-announced/\"\u003eGemini 1.5 Flash\u003c/a\u003e on these datasets. For ICL, they fed the entire training dataset (or large subsets) as context to an instruction-tuned model before posing the test questions.\u003c/p\u003e\n\n\n\n\u003cp\u003eThe results consistently showed that, in data-matched settings, ICL led to better generalization than standard fine-tuning. Models using ICL were generally better at tasks like reversing relationships or making logical deductions from the provided context. Pre-trained models, without fine-tuning or ICL, performed poorly, indicating the novelty of the test data. \u003c/p\u003e\n\n\n\n\u003cp\u003e“One of the main trade-offs to consider is that, whilst ICL doesn’t require fine-tuning (which saves the training costs), it is generally more computationally expensive with each use, since it requires providing additional context to the model,” Lampinen said. “On the other hand, ICL tends to generalize better for the datasets and models that we evaluated.”\u003c/p\u003e\n\n\n\n\u003ch2 id=\"h-a-hybrid-approach-augmenting-fine-tuning\"\u003e\u003cstrong\u003eA hybrid approach: Augmenting fine-tuning\u003c/strong\u003e\u003c/h2\u003e\n\n\n\n\u003cp\u003eBuilding on the observation that ICL excels at flexible generalization, the researchers proposed a new method to enhance fine-tuning: adding in-context inferences to fine-tuning data. The core idea is to use the LLM’s own ICL capabilities to generate more diverse and richly inferred examples, and then add these augmented examples to the dataset used for fine-tuning.\u003c/p\u003e\n\n\n\n\u003cp\u003eThey explored two main data augmentation strategies:\u003c/p\u003e\n\n\n\n\u003col\u003e\n\u003cli\u003eA \u003cstrong\u003elocal strategy\u003c/strong\u003e: This approach focuses on individual pieces of information. The LLM is prompted to rephrase single sentences from the training data or draw direct inferences from them, such as generating reversals. \u003c/li\u003e\n\n\n\n\u003cli\u003eA \u003cstrong\u003eglobal strategy\u003c/strong\u003e: The LLM is given the full training dataset as context, then prompted to generate inferences by linking a particular document or fact with the rest of the provided information, leading to a longer reasoning trace of relevant inferences.\u003c/li\u003e\n\u003c/ol\u003e\n\n\n\n\u003cp\u003eWhen the models were fine-tuned on these augmented datasets, the gains were significant. This augmented fine-tuning significantly improved generalization, outperforming not only standard fine-tuning but also plain ICL. \u003c/p\u003e\n\n\n\n\u003cfigure\u003e\u003cimg fetchpriority=\"high\" decoding=\"async\" width=\"1478\" height=\"520\" src=\"https://venturebeat.com/wp-content/uploads/2025/05/image_1e1119.png?w=800\" alt=\"\" srcset=\"https://venturebeat.com/wp-content/uploads/2025/05/image_1e1119.png 1478w, https://venturebeat.com/wp-content/uploads/2025/05/image_1e1119.png?resize=300,106 300w, https://venturebeat.com/wp-content/uploads/2025/05/image_1e1119.png?resize=768,270 768w, https://venturebeat.com/wp-content/uploads/2025/05/image_1e1119.png?resize=800,281 800w, https://venturebeat.com/wp-content/uploads/2025/05/image_1e1119.png?resize=400,141 400w, https://venturebeat.com/wp-content/uploads/2025/05/image_1e1119.png?resize=750,264 750w, https://venturebeat.com/wp-content/uploads/2025/05/image_1e1119.png?resize=578,203 578w, https://venturebeat.com/wp-content/uploads/2025/05/image_1e1119.png?resize=930,327 930w\" sizes=\"(max-width: 1478px) 100vw, 1478px\"/\u003e\u003c/figure\u003e\n\n\n\n\u003cp\u003e“For example, if one of the company documents says ‘XYZ is an internal tool for analyzing data,’ our results suggest that ICL and augmented finetuning will be more effective at enabling the model to answer related questions like ‘What internal tools for data analysis exist?’” Lampinen said.\u003c/p\u003e\n\n\n\n\u003cp\u003eThis approach offers a compelling path forward for enterprises. By investing in creating these ICL-augmented datasets, developers can build fine-tuned models that exhibit stronger generalization capabilities.\u003c/p\u003e\n\n\n\n\u003cp\u003eThis can lead to more robust and reliable LLM applications that perform better on diverse, real-world inputs without incurring the continuous inference-time costs associated with large in-context prompts. \u003c/p\u003e\n\n\n\n\u003cp\u003e“Augmented fine-tuning will generally make the model fine-tuning process more expensive, because it requires an additional step of ICL to augment the data, followed by fine-tuning,” Lampinen said. “Whether that additional cost is merited by the improved generalization will depend on the specific use case. However, it is computationally cheaper than applying ICL every time the model is used, when amortized over many uses of the model.”\u003c/p\u003e\n\n\n\n\u003cp\u003eWhile Lampinen noted that further research is needed to see how the components they studied interact in different settings, he added that their findings indicate that developers may want to consider exploring augmented fine-tuning in cases where they see inadequate performance from fine-tuning alone. \u003c/p\u003e\n\n\n\n\u003cp\u003e“Ultimately, we hope this work will contribute to the science of understanding learning and generalization in foundation models, and the practicalities of adapting them to downstream tasks,” Lampinen said.\u003c/p\u003e\n\u003cdiv id=\"boilerplate_2660155\"\u003e\n\t\t\t\u003cdiv\u003e\n\t\t\t\t\u003cp\u003e\u003cstrong\u003eDaily insights on business use cases with VB Daily\u003c/strong\u003e\u003c/p\u003e\n\t\t\t\t\u003cp\u003eIf you want to impress your boss, VB Daily has you covered. We give you the inside scoop on what companies are doing with generative AI, from regulatory shifts to practical deployments, so you can share insights for maximum ROI.\u003c/p\u003e\n\t\t\t\t\n\t\t\t\t\u003cp\u003eRead our \u003ca href=\"https://venturebeat.com/terms-of-service/\"\u003ePrivacy Policy\u003c/a\u003e\u003c/p\u003e\n\t\t\t\t\u003cp id=\"boilerplateNewsletterConfirmation\"\u003e\n\t\t\t\t\tThanks for subscribing. Check out more \u003ca href=\"https://venturebeat.com/newsletters/\"\u003eVB newsletters here\u003c/a\u003e.\n\t\t\t\t\u003c/p\u003e\n\t\t\t\t\u003cp\u003eAn error occured.\u003c/p\u003e\n\t\t\t\u003c/div\u003e\n\n\t\t\t\t\t\t\t\u003cp\u003e\u003cimg src=\"https://venturebeat.com/wp-content/themes/vb-news/brand/img/vb-daily-phone.png\" alt=\"\"/\u003e\n\t\t\t\t\u003c/p\u003e\n\t\t\t\n\t\t\u003c/div\u003e\t\t\t\u003c/div\u003e\n\n\t\t\t\t\t\t\t\n\t\t\t\n\t\t\u003c/article\u003e\n\n\t\u003c/div\u003e\u003c/div\u003e",
  "readingTime": "8 min read",
  "publishedTime": "2025-05-10T00:23:09Z",
  "modifiedTime": "2025-05-10T00:23:23Z"
}
