{
  "id": "42d60a07-4c5c-4bcf-a88f-4484b1df5c97",
  "title": "Some tips while building Android project with C++ / NDK code",
  "link": "https://proandroiddev.com/some-tips-while-building-android-project-with-c-ndk-code-8df7f6c01e58?source=rss----c72404660798---4",
  "description": "",
  "author": "Dilipchandar",
  "published": "Thu, 20 Feb 2025 16:03:19 GMT",
  "source": "https://proandroiddev.com/feed",
  "categories": [
    "android-app-development",
    "androiddev",
    "android",
    "programming",
    "android-ndk"
  ],
  "byline": "Dilipchandar",
  "length": 3000,
  "excerpt": "Once the solution is applied, you should see the updated version in gradle-wrapper.properties file like below To solve the above issue, we need to check and update the CMake version in app’s…",
  "siteName": "ProAndroidDev",
  "favicon": "https://miro.medium.com/v2/resize:fill:256:256/1*A8VytPZQhvUf_MG6hm_Dlw.png",
  "text": "Problems and SolutionsThis article is about the problems faced while importing Android project with C++ or NDK code.First and foremost, download NDK and CMake from SDK Tools as shown in the screenshot below.As you can see, NDK (Side by side) and CMake is already installed in my Android Studio.Issue 1:After importing an Android project (not only C++ or NDK code), you may get the following error.Error:Your build is currently configured to use Gradle 8.0. Cannot sync the project. We recommend upgrading to Gradle version 8.9. The minimum compatible Gradle version is 8.5. We recommend upgrading to Gradle version 8.9.The minimum compatible Gradle version is 8.5.Possible solutions: — Upgrade to Gradle 8.9 and re-sync — Upgrade to Gradle 8.5 and re-syncSolution:For the above issue, solution is simple.Upgrade Android Gradle Plugin (AGP) to the required version (8.5 or 8.9)Once the solution is applied, you should see the updated version in gradle-wrapper.properties file like belowdistributionUrl=https\\://services.gradle.org/distributions/gradle-8.9-bin.zipIssue 2:While building Android project with C++ or NDK code, you may get the following error.Error::app debug:arm64-v8a failed to configure C/C++Solution:To solve the above issue, we need to check and update the CMake version in app’s build.gradle like below.externalNativeBuild { cmake { path \"src/main/cpp/Android/CMakeLists.txt\" version \"3.31.5\" }}In my case, CMake version was 3.10.2. I upgraded it to 3.31.5 and that solved the issue.Issue 3: (Runtime issue)After solving Issue 1 and Issue 2, we may get runtime issuesError:org.gradle.workers.WorkerExecutionException: There were multiple failures while executing work itemsCaused by: org.gradle.tooling.BuildException: Failed to process:Caused by: com.android.builder.dexing.DexArchiveBuilderException: Failed to process:After seeing DexArchiveBuilderException, one thing that might come in mind is about enabling MultiDex but that is not the issue here.Solution:Upgrading JavaVersionFromcompileOptions { sourceCompatibility JavaVersion.VERSION_1_8 targetCompatibility JavaVersion.VERSION_1_8}TocompileOptions { sourceCompatibility JavaVersion.VERSION_11 targetCompatibility JavaVersion.VERSION_11 }worked for me.Issue 4:After solving Issue 3, we may get the following error.Error:Execution failed for task ‘:app:compileDebugJavaWithJavac’.\u003e Could not resolve all files for configuration ‘:app:androidJdkImage’.Solution:After searching for the solution in StackOverFlow, got the below solution.Update plugin version of our app in project’s build.gradle.In my case, updatingFromplugins {id 'com.android.application' version '8.0.0' apply false}Toplugins { id 'com.android.application' version '8.3.2' apply false}solved the issue.Another tip:Directly applying solution of Issue 4 i.e updating plugin of our app in project’s build.gradle solved Issue 3(which means we can skip solution of upgrading JavaVersion). This was found out later.",
  "image": "https://miro.medium.com/v2/resize:fit:527/1*OoHztQvjCqxQBXUnyUPFsw.jpeg",
  "html": "\u003cdiv id=\"readability-page-1\" class=\"page\"\u003e\u003carticle\u003e\u003cdiv\u003e\u003cdiv\u003e\u003cdiv\u003e\u003ch2 id=\"c903\"\u003eProblems and Solutions\u003c/h2\u003e\u003cdiv\u003e\u003cdiv aria-hidden=\"false\"\u003e\u003ca href=\"https://medium.com/@dilipchandar89?source=post_page---byline--8df7f6c01e58---------------------------------------\" rel=\"noopener follow\"\u003e\u003cdiv\u003e\u003cp\u003e\u003cimg alt=\"Dilipchandar\" src=\"https://miro.medium.com/v2/resize:fill:88:88/1*_ahsRfI76vTCn4JWIGHHGg.jpeg\" width=\"44\" height=\"44\" loading=\"lazy\" data-testid=\"authorPhoto\"/\u003e\u003c/p\u003e\u003c/div\u003e\u003c/a\u003e\u003c/div\u003e\u003cdiv aria-hidden=\"false\"\u003e\u003ca href=\"https://proandroiddev.com/?source=post_page---byline--8df7f6c01e58---------------------------------------\" rel=\"noopener  ugc nofollow\"\u003e\u003cdiv\u003e\u003cp\u003e\u003cimg alt=\"ProAndroidDev\" src=\"https://miro.medium.com/v2/resize:fill:48:48/1*XVtdl45m8YaYrPI4buJ5yQ.png\" width=\"24\" height=\"24\" loading=\"lazy\" data-testid=\"publicationPhoto\"/\u003e\u003c/p\u003e\u003c/div\u003e\u003c/a\u003e\u003c/div\u003e\u003c/div\u003e\u003c/div\u003e\u003cfigure\u003e\u003c/figure\u003e\u003cp id=\"0749\"\u003eThis article is about the problems faced while importing Android project with C++ or NDK code.\u003c/p\u003e\u003cp id=\"8a36\"\u003eFirst and foremost, download \u003ca href=\"https://developer.android.com/ndk\" rel=\"noopener ugc nofollow\" target=\"_blank\"\u003e\u003cstrong\u003eNDK\u003c/strong\u003e\u003c/a\u003e and \u003ca href=\"https://developer.android.com/ndk/guides/cmake\" rel=\"noopener ugc nofollow\" target=\"_blank\"\u003e\u003cstrong\u003eCMake\u003c/strong\u003e\u003c/a\u003e from SDK Tools as shown in the screenshot below.\u003c/p\u003e\u003cfigure\u003e\u003c/figure\u003e\u003cp id=\"926b\"\u003eAs you can see, \u003cstrong\u003eNDK (Side by side) and CMake\u003c/strong\u003e is already installed in my Android Studio.\u003c/p\u003e\u003cp id=\"2b50\"\u003e\u003cstrong\u003eIssue 1:\u003c/strong\u003e\u003c/p\u003e\u003cp id=\"f265\"\u003eAfter importing an Android project (not only C++ or NDK code), you may get the following error.\u003c/p\u003e\u003cp id=\"17a0\"\u003e\u003cstrong\u003eError:\u003c/strong\u003e\u003c/p\u003e\u003cblockquote\u003e\u003cp id=\"2cb2\"\u003eYour build is currently configured to use Gradle 8.0. Cannot sync the project. We recommend upgrading to Gradle version 8.9. The minimum compatible Gradle version is 8.5. We recommend upgrading to Gradle version 8.9.\u003c/p\u003e\u003cp id=\"269a\"\u003eThe minimum compatible Gradle version is 8.5.\u003c/p\u003e\u003cp id=\"2bd2\"\u003ePossible solutions:\u003cbr/\u003e — Upgrade to Gradle 8.9 and re-sync\u003cbr/\u003e — Upgrade to Gradle 8.5 and re-sync\u003c/p\u003e\u003c/blockquote\u003e\u003cp id=\"4aae\"\u003e\u003cstrong\u003eSolution:\u003c/strong\u003e\u003c/p\u003e\u003cp id=\"b3ce\"\u003eFor the above issue, solution is simple.\u003c/p\u003e\u003cp id=\"e077\"\u003eUpgrade \u003cstrong\u003e\u003cem\u003eAndroid Gradle Plugin\u003c/em\u003e\u003c/strong\u003e (AGP) to the required version (8.5 or 8.9)\u003c/p\u003e\u003cp id=\"5203\"\u003eOnce the solution is applied, you should see the updated version in \u003cstrong\u003egradle-wrapper.properties \u003c/strong\u003efile\u003cstrong\u003e \u003c/strong\u003elike below\u003c/p\u003e\u003cpre\u003e\u003cspan id=\"bc95\"\u003edistributionUrl=https\\://services.gradle.org/distributions/gradle-8.9-bin.zip\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv\u003e\u003cp id=\"5ce2\"\u003e\u003cstrong\u003eIssue 2:\u003c/strong\u003e\u003c/p\u003e\u003cp id=\"293a\"\u003eWhile building Android project with C++ or NDK code, you may get the following error.\u003c/p\u003e\u003cp id=\"3aee\"\u003e\u003cstrong\u003eError:\u003c/strong\u003e\u003c/p\u003e\u003cblockquote\u003e\u003cp id=\"8879\"\u003e:app debug:arm64-v8a failed to configure C/C++\u003c/p\u003e\u003c/blockquote\u003e\u003cp id=\"23b4\"\u003e\u003cstrong\u003eSolution:\u003c/strong\u003e\u003c/p\u003e\u003cp id=\"83c7\"\u003eTo solve the above issue, we need to check and update the CMake version in \u003cstrong\u003eapp’s build.gradle\u003c/strong\u003e like below.\u003c/p\u003e\u003cpre\u003e\u003cspan id=\"76d5\"\u003eexternalNativeBuild {\u003cbr/\u003e    cmake {\u003cbr/\u003e        path \u0026#34;src/main/cpp/Android/CMakeLists.txt\u0026#34;\u003cbr/\u003e        version \u0026#34;3.31.5\u0026#34;\u003cbr/\u003e    }\u003cbr/\u003e}\u003c/span\u003e\u003c/pre\u003e\u003cp id=\"b88f\"\u003eIn my case, CMake version was 3.10.2. I upgraded it to 3.31.5 and that solved the issue.\u003c/p\u003e\u003c/div\u003e\u003cdiv\u003e\u003cp id=\"1e3a\"\u003e\u003cstrong\u003eIssue 3: (Runtime issue)\u003c/strong\u003e\u003c/p\u003e\u003cp id=\"1b92\"\u003eAfter solving Issue 1 and Issue 2, we may get runtime issues\u003c/p\u003e\u003cp id=\"4e1a\"\u003eError:\u003c/p\u003e\u003cblockquote\u003e\u003cp id=\"0d62\"\u003eorg.gradle.workers.WorkerExecutionException: There were multiple failures while executing work items\u003c/p\u003e\u003cp id=\"6d58\"\u003eCaused by: org.gradle.tooling.BuildException: Failed to process:\u003c/p\u003e\u003cp id=\"22ea\"\u003eCaused by: com.android.builder.dexing.DexArchiveBuilderException: Failed to process:\u003c/p\u003e\u003c/blockquote\u003e\u003cp id=\"8107\"\u003eAfter seeing \u003cstrong\u003eDexArchiveBuilderException\u003c/strong\u003e, one thing that might come in mind is about enabling \u003ca href=\"https://developer.android.com/build/multidex\" rel=\"noopener ugc nofollow\" target=\"_blank\"\u003e\u003cstrong\u003eMultiDex\u003c/strong\u003e\u003c/a\u003e but that is not the issue here.\u003c/p\u003e\u003cp id=\"5206\"\u003e\u003cstrong\u003eSolution:\u003c/strong\u003e\u003c/p\u003e\u003cp id=\"5211\"\u003eUpgrading \u003cstrong\u003eJavaVersion\u003c/strong\u003e\u003c/p\u003e\u003cp id=\"3858\"\u003eFrom\u003c/p\u003e\u003cpre\u003e\u003cspan id=\"5fb0\"\u003ecompileOptions {\u003cbr/\u003e    sourceCompatibility JavaVersion.VERSION_1_8\u003cbr/\u003e    targetCompatibility JavaVersion.VERSION_1_8\u003cbr/\u003e}\u003c/span\u003e\u003c/pre\u003e\u003cp id=\"5ea6\"\u003eTo\u003c/p\u003e\u003cpre\u003e\u003cspan id=\"bcd2\"\u003ecompileOptions {\u003cbr/\u003e        sourceCompatibility JavaVersion.VERSION_11\u003cbr/\u003e        targetCompatibility JavaVersion.VERSION_11\u003cbr/\u003e    }\u003c/span\u003e\u003c/pre\u003e\u003cp id=\"ec3b\"\u003eworked for me.\u003c/p\u003e\u003c/div\u003e\u003cdiv\u003e\u003cp id=\"4862\"\u003e\u003cstrong\u003eIssue 4:\u003c/strong\u003e\u003c/p\u003e\u003cp id=\"850d\"\u003eAfter solving Issue 3, we may get the following error.\u003c/p\u003e\u003cp id=\"b104\"\u003e\u003cstrong\u003eError:\u003c/strong\u003e\u003c/p\u003e\u003cblockquote\u003e\u003cp id=\"d371\"\u003eExecution failed for task ‘:app:compileDebugJavaWithJavac’.\u003cbr/\u003e\u0026gt; Could not resolve all files for configuration ‘:app:androidJdkImage’.\u003c/p\u003e\u003c/blockquote\u003e\u003cp id=\"f3f4\"\u003e\u003cstrong\u003eSolution:\u003c/strong\u003e\u003c/p\u003e\u003cp id=\"7c7a\"\u003eAfter searching for the solution in StackOverFlow, got the below solution.\u003c/p\u003e\u003cp id=\"22f6\"\u003eUpdate plugin version of our app in project’s build.gradle.\u003c/p\u003e\u003cp id=\"f056\"\u003eIn my case, updating\u003c/p\u003e\u003cp id=\"7848\"\u003eFrom\u003c/p\u003e\u003cpre\u003e\u003cspan id=\"81e2\"\u003eplugins {\u003cbr/\u003eid \u0026#39;com.android.application\u0026#39; version \u0026#39;8.0.0\u0026#39; apply false\u003cbr/\u003e}\u003c/span\u003e\u003c/pre\u003e\u003cp id=\"3a0b\"\u003eTo\u003c/p\u003e\u003cpre\u003e\u003cspan id=\"d2de\"\u003eplugins {\u003cbr/\u003e    id \u0026#39;com.android.application\u0026#39; version \u0026#39;8.3.2\u0026#39; apply false\u003cbr/\u003e}\u003c/span\u003e\u003c/pre\u003e\u003cp id=\"349c\"\u003esolved the issue.\u003c/p\u003e\u003cp id=\"3960\"\u003e\u003cstrong\u003eAnother tip:\u003c/strong\u003e\u003c/p\u003e\u003cp id=\"1bb6\"\u003eDirectly applying solution of \u003cstrong\u003eIssue 4\u003c/strong\u003e i.e updating plugin of our app in project’s build.gradle solved \u003cstrong\u003eIssue 3\u003c/strong\u003e(which means we can skip solution of upgrading \u003cstrong\u003eJavaVersion\u003c/strong\u003e). This was found out later.\u003c/p\u003e\u003c/div\u003e\u003c/div\u003e\u003c/article\u003e\u003c/div\u003e",
  "readingTime": "4 min read",
  "publishedTime": "2025-02-20T16:03:19.284Z",
  "modifiedTime": null
}
