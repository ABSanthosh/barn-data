{
  "id": "e658e2c0-78e3-4b02-b281-c14c95a252f1",
  "title": "HashiCorp Terraform 1.10 adds Ephemeral Values to Improve Secret Management",
  "link": "https://www.infoq.com/news/2024/11/terraform-1-10-ephemeral-values/?utm_campaign=infoq_content\u0026utm_source=infoq\u0026utm_medium=feed\u0026utm_term=global",
  "description": "HashiCorp has released Terraform 1.10, which introduces ephemeral values - a concept designed to protect sensitive information, such as passwords, which is often required to provision infrastructure with Terraform. By Matt Saunders",
  "author": "Matt Saunders",
  "published": "Sat, 30 Nov 2024 21:00:00 GMT",
  "source": "https://feed.infoq.com",
  "categories": [
    "Configuration Management",
    "Terraform",
    "Cloud Architecture",
    "DevOps",
    "news"
  ],
  "byline": "Matt Saunders",
  "length": 4075,
  "excerpt": "HashiCorp has released Terraform 1.10, which introduces ephemeral values - a concept designed to protect sensitive information, such as passwords, which is often required to provision infrastructure w",
  "siteName": "InfoQ",
  "favicon": "https://cdn.infoq.com/statics_s2_20241128133046/apple-touch-icon.png",
  "text": "HashiCorp has released Terraform 1.10, which introduces ephemeral values - a concept designed to protect sensitive information, such as passwords, which is often required to provision infrastructure with Terraform. Considered a weakness in earlier versions, the technique of storing secrets within Terraform plan and state files, where they would often be in plaintext, has now been superseded by ephemeral values. These provide a secure alternative by ensuring that sensitive data are not persisted in any Terraform artefacts. Key features of ephemeral values include: Ephemeral input and output variables: Allows marking variables that need to exist only temporarily, such as short-lived tokens or session identifiers. Ephemeral resources: A new resource mode that can be created or fetched separately for each Terraform phase, used to configure objects, and then explicitly closed. The blog demonstrates ephemeral values through an example involving AWS Secrets Manager. Previously, secrets fetched through data sources would be stored in the Terraform plan and state files, but with ephemeral values, the secret is retrieved and used without being permanently stored anywhere else. Ephemeral resources are available for major cloud providers, including AWS, Azure, and Kubernetes, though the provider must support the required resources. Some in the community found this ambiguous, and pointed out that Hashicorp's own Vault provider does not yet appear to have ephemeral resources. Google Cloud support has also not yet been released, but it is scheduled for December 9th. The providers and their corresponding ephemeral resources are: AWS: aws_secretsmanager_secret_version, aws_lambda_invocation Azure: azurerm_key_vault_secret, azurerm_key_vault_certificate Kubernetes: kubernetes_token_request, kubernetes_certificate_signing_request In a LinkedIn post, Achim Christ explores the motivation for ephemeral values - explaining how it is an alternative to encrypting the Terraform state file: Folks at HashiCorp have argued that encrypting the entire state is not ideal, as it introduces another secret — the cryptographic key — which must also be managed. Thus, traditional state encryption may still expose sensitive data if compromised Terraform environments allow unauthorized access, a risk known as \"secret sprawl\". - Achim Christ However, some commenters don't believe this is a good solution, with Alexandre Nédélec suggesting on Bluesky that secrets encryption may be a better approach. Not really convinced by ephemeral values of Terraform 1.10. Secrets encryption just seem a better solution. Pulumi does it. OpenTofu allows state encryption. I don't understand why Terraform does not do it. - Alexandre Nédélec Christ goes on to give examples of how to use ephemeral inputs, outputs and variables. He also explains the use case for write-only attributes, which are planned for Terraform 1.11. He summarises that \"the concept of ephemerality is a valuable addition to the core Terraform configuration language\". Other reaction has also been positive, with Marko Bevc speaking of the benefits around safely storing passwords in a post on Bluesky. Quite excited about #Terraform v1.10 release . It's introducing ephemeral resources and values, which are read anew during each phase of Terraform evaluation, and aren't persisted in state. I think this gives us a better story around safely storing sensitive values. - Marko Bevc In addition to secret management improvements, Terraform 1.10 includes some performance enhancements, improving Terraform plan and apply operations where a large number of resource instances are used. It's as yet unclear whether Terraform fork OpenTofu will be implementing ephemeral values. An issue is, however, open on OpenTofu's GitHub account to track this. Terraform 1.10 is now ready for download and is also available in HCP Terraform. About the Author Matt Saunders",
  "image": "https://res.infoq.com/news/2024/11/terraform-1-10-ephemeral-values/en/headerimage/generatedHeaderImage-1732998541809.jpg",
  "html": "\u003cdiv id=\"readability-page-1\" class=\"page\"\u003e\u003cdiv\u003e\n\t\t\t\t\t\t\t\t\u003cp\u003e\u003ca href=\"https://www.hashicorp.com/\"\u003eHashiCorp\u003c/a\u003e has released \u003ca href=\"https://www.hashicorp.com/blog/terraform-1-10-improves-handling-secrets-in-state-with-ephemeral-values\"\u003eTerraform 1.10\u003c/a\u003e, which introduces ephemeral values - a concept designed to protect sensitive information, such as passwords, which is often required to provision infrastructure with Terraform.\u003c/p\u003e\n\n\u003cp\u003eConsidered a weakness in earlier versions, the technique of storing secrets within Terraform \u003ctt\u003eplan\u003c/tt\u003e and \u003ctt\u003estate\u003c/tt\u003e files, where they would often be in plaintext, has now been superseded by ephemeral values. These provide a secure alternative by ensuring that sensitive data are not persisted in any Terraform artefacts.\u003c/p\u003e\n\n\u003cp\u003eKey features of ephemeral values include:\u003c/p\u003e\n\n\u003cul\u003e\n\t\u003cli\u003e\u003cstrong\u003eEphemeral input and output variables:\u003c/strong\u003e Allows marking variables that need to exist only temporarily, such as short-lived tokens or session identifiers.\u003c/li\u003e\n\t\u003cli\u003e\u003cstrong\u003eEphemeral resources:\u003c/strong\u003e A new resource mode that can be created or fetched separately for each Terraform phase, used to configure objects, and then explicitly closed.\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eThe blog demonstrates ephemeral values through an example involving \u003ca href=\"https://docs.aws.amazon.com/secretsmanager/latest/userguide/intro.html\"\u003eAWS Secrets Manager\u003c/a\u003e. Previously, secrets fetched through data sources would be stored in the Terraform \u003ctt\u003eplan\u003c/tt\u003e and \u003ctt\u003estate\u003c/tt\u003e files, but with ephemeral values, the secret is retrieved and used without being permanently stored anywhere else.\u003c/p\u003e\n\n\u003cp\u003e\u003cimg alt=\"Terraform ephemeral values\" data-src=\"news/2024/11/terraform-1-10-ephemeral-values/en/resources/1Screenshot from 2024-11-30 20-15-13-1732998540917.png\" src=\"https://imgopt.infoq.com/fit-in/3000x4000/filters:quality(85)/filters:no_upscale()/news/2024/11/terraform-1-10-ephemeral-values/en/resources/1Screenshot from 2024-11-30 20-15-13-1732998540917.png\" rel=\"share\"/\u003e\u003c/p\u003e\n\n\u003cp\u003eEphemeral resources are available for major cloud providers, including AWS, Azure, and Kubernetes, though the provider must support the required resources. Some in the community found this ambiguous, and pointed out that Hashicorp\u0026#39;s own Vault provider \u003ca href=\"https://www.reddit.com/r/Terraform/comments/1h14dfc/comment/lzh3ro7/\"\u003edoes not yet appear to have ephemeral resources\u003c/a\u003e. Google Cloud support has also not yet been released, but it is scheduled for December 9th. The providers and their corresponding ephemeral resources are:\u003c/p\u003e\n\n\u003cul\u003e\n\t\u003cli\u003e\u003cstrong\u003eAWS:\u003c/strong\u003e \u003ccode\u003eaws_secretsmanager_secret_version\u003c/code\u003e, \u003ccode\u003eaws_lambda_invocation\u003c/code\u003e\u003c/li\u003e\n\t\u003cli\u003e\u003cstrong\u003eAzure:\u003c/strong\u003e \u003ccode\u003eazurerm_key_vault_secret, azurerm_key_vault_certificate\u003c/code\u003e\u003c/li\u003e\n\t\u003cli\u003e\u003cstrong\u003eKubernetes:\u003c/strong\u003e \u003ccode\u003ekubernetes_token_request\u003c/code\u003e, \u003ccode\u003ekubernetes_certificate_signing_request\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eIn a \u003ca href=\"https://www.linkedin.com/pulse/exploring-ephemerality-terraform-110-beyond-achim-christ-0pn1e/\"\u003eLinkedIn post\u003c/a\u003e, Achim Christ explores the motivation for ephemeral values - explaining how it is an alternative to encrypting the Terraform state file:\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eFolks at HashiCorp have argued that encrypting the entire state is not ideal, as it introduces another secret — the cryptographic key — which must also be managed. Thus, traditional state encryption may still expose sensitive data if compromised Terraform environments allow unauthorized access, a risk known as \u0026#34;secret sprawl\u0026#34;.\u003c/p\u003e\n\n\u003cp\u003e- Achim Christ\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eHowever, some commenters don\u0026#39;t believe this is a good solution, with Alexandre Nédélec suggesting on Bluesky that secrets encryption may be a better approach.\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eNot really convinced by ephemeral values of Terraform 1.10. Secrets encryption just seem a better solution. Pulumi does it. OpenTofu allows state encryption. I don\u0026#39;t understand why Terraform does not do it.\u003c/p\u003e\n\n\u003cp\u003e- \u003ca href=\"https://bsky.app/profile/techwatching.bsky.social/post/3lbxirfjlgc2r\"\u003eAlexandre Nédélec\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eChrist goes on to give examples of how to use ephemeral inputs, outputs and variables. He also explains the use case for write-only attributes, which are planned for Terraform 1.11. He summarises that \u0026#34;the concept of ephemerality is a valuable addition to the core Terraform configuration language\u0026#34;. Other reaction has also been positive, with Marko Bevc speaking of the benefits around safely storing passwords in a post on Bluesky.\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eQuite excited about #Terraform v1.10 release . It\u0026#39;s introducing ephemeral resources and values, which are read anew during each phase of Terraform evaluation, and aren\u0026#39;t persisted in state. I think this gives us a better story around safely storing sensitive values.\u003c/p\u003e\n\n\u003cp\u003e- \u003ca href=\"https://bsky.app/profile/marko.social/post/3lbwi73xsfs2w\"\u003eMarko Bevc\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eIn addition to secret management improvements, Terraform 1.10 includes some performance enhancements, improving Terraform plan and apply operations where a large number of resource instances are used.\u003c/p\u003e\n\n\u003cp\u003eIt\u0026#39;s as yet unclear whether Terraform fork OpenTofu will be implementing ephemeral values. An issue is, however, \u003ca href=\"https://github.com/opentofu/opentofu/issues/1996\"\u003eopen\u003c/a\u003e on OpenTofu\u0026#39;s GitHub account to track this.\u003c/p\u003e\n\n\u003cp\u003eTerraform 1.10 is now \u003ca href=\"https://developer.hashicorp.com/terraform/install?product_intent=terraform\"\u003eready for download\u003c/a\u003e and is also available in \u003ca href=\"https://www.hashicorp.com/products/terraform\"\u003eHCP Terraform\u003c/a\u003e.\u003c/p\u003e\n\n\t\t\t\t\t\t\t\t\n\n\n\n\n\n\n\n\n\n  \n    \u003cdiv\u003e \n        \u003ch2\u003eAbout the Author\u003c/h2\u003e \n\n        \n            \n                \n            \n            \u003cdiv data-id=\"author-Matt-Saunders\"\u003e\n                    \u003ch4\u003e\u003cstrong\u003eMatt Saunders\u003c/strong\u003e\u003c/h4\u003e\n                    \n                \u003c/div\u003e\n        \n    \u003c/div\u003e\n\n\t\t\t\t\t\t\t\u003c/div\u003e\u003c/div\u003e",
  "readingTime": "5 min read",
  "publishedTime": "2024-11-30T00:00:00Z",
  "modifiedTime": null
}
