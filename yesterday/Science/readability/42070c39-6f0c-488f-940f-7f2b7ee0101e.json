{
  "id": "42070c39-6f0c-488f-940f-7f2b7ee0101e",
  "title": "The Surprisingly Difficult Mathematical Proof That Anime Fans Helped Solve",
  "link": "https://www.scientificamerican.com/article/the-surprisingly-difficult-mathematical-proof-that-anime-fans-helped-solve/",
  "description": "When a fan of a cult anime series wanted to watch its episodes in every possible order, they asked a question that had perplexed combinatorial mathematicians for years",
  "author": "",
  "published": "Mon, 03 Mar 2025 13:00:00 +0000",
  "source": "http://rss.sciam.com/ScientificAmerican-Global",
  "categories": null,
  "byline": "Manon Bischoff",
  "length": 8900,
  "excerpt": "When a fan of a cult anime series wanted to watch its episodes in every possible order, they asked a question that had perplexed combinatorial mathematicians for years",
  "siteName": "Scientific American",
  "favicon": "",
  "text": "Math solutions can be found in surprising places, including the dark realms of the Internet. In 2011 an anonymous poster on the now infamously controversial image board 4chan posed a mathematical puzzle about the cult classic anime series The Melancholy of Haruhi Suzumiya. Though the bulletin board has become littered with hateful, violent and extreme content, that original post led to a solution to the sophisticated math problem.The first season of this anime series consists of 14 episodes that were designed so that you can watch them in any order you like. (For people who are as unfamiliar with the anime world as I am: an eight-part live-action thriller called Kaleidoscope on Netflix follows the same principle.) At some point in a 2011 discussion of the series on 4chan, someone asked the minimum number of episodes they would have to watch to have seen it in every possible order.In fact, this question is related to so-called superpermutations. And as it turns out, this mathematical area holds many puzzles: to this day, mathematicians are still unable to fully answer the problem that the 4chan user had posed.On supporting science journalismIf you're enjoying this article, consider supporting our award-winning journalism by subscribing. By purchasing a subscription you are helping to ensure the future of impactful stories about the discoveries and ideas shaping our world today.But amazingly, in that discussion, one of the anonymous users made an estimate of the minimum amount of all episodes to watch with an approach that was previously unknown to mathematicians. “I’ll need to [elaborate on] this in multiple posts. Please look it over for any loopholes I might have missed,” wrote the user, who explained in several steps how they arrived at their estimate. Other users then took up the arguments and discussed them—but outside of 4chan, none of this made any waves. No one seemed to take any notice.Extreme Binge-WatchingIn mathematics, two objects permutate when they are rearranged or recombined. For example, you can permutate AB to BA. If an anime series consisted of only two parts, you could either watch the first and then the second episode (1-2) or the second and then the first (2-1).If you want to watch a series in multiple arrangements—perhaps to figure out which sequence of episodes makes the most sense—you need a superpermutation. This is a sequence of all possible permutations. Imagine a marathon showing where you watch the first episode, followed by the second, and then watch the second episode, followed by the first (1-2-2-1). To avoid watching the second episode twice in a row, a shorter superpermutation would be 1-2-1; you would only have to watch three episodes to still have every possible order covered.If a series consists of three episodes, it becomes a little trickier to find the shortest superpermutation. In this case, there are 3! = 6 different sequences: 1-2-3, 1-3-2, 2-3-1, 2-1-3, 3-1-2, 3-2-1. Fortunately, you don’t have to watch 3 × 6 = 18 parts but can find a clever shortcut, in this case: 1-2-3-1-2-1-3-2-1. That order contains all possible permutations of the numbers 1, 2 and 3, but you only have to watch nine episodes!Mathematicians have also calculated the shortest superpermutations for a series consisting of n = 4 and n = 5 episodes (33 and 153 episodes, respectively). Beyond that, however, they are in the dark. The shortest superpermutations for n \u003e 5 are not known.In fact, the challenge relates to one of the most intractable problems in algorithmics: the traveling salesperson problem. In this problem, a person wants to visit different cities and end up back in their hometown. The task is to find the shortest route that connects all the cities. The shortest superpermutation is a variation of this problem in which the individual permutations represent different cities. In this case, you assign different distances between cities by determining the overlap of the permutations. For example, cities 1-2-3 and 2-3-1 have a large overlap: the last two digits of the first permutation match the first two digits of the second, so they can be combined to form 1-2-3-1. We can therefore assign a short distance between those two cities. On the other hand, 1-2-3 and 2-1-3 do not overlap. (To see both sequences, you have to look at a full six parts; no shortcut is possible.) Thus, these cities have a large distance between them.To find the shortest route within permutations, you connect the permutations that overlap the most. There is only one difficulty: there is no known algorithm that solves the traveling salesperson problem quickly. If we are dealing with a few cities—or, in the case of an anime series, a few episodes—this is not a major drawback. But as soon as the n becomes large, computers fail at the task because the computing time grows exponentially with n.Computers are able to calculate superpermutations for n = 4 and n = 5 but not for anything beyond that. And although it is possible to calculate elaborate superpermutations for larger numbers, finding the shortest superpermutation becomes more difficult.Experts must therefore make do with estimates. For example, there is an algorithm that helps estimate the length of the shortest possible superpermutation for n objects: 1! + 2! + 3! + ... + n! Using that algorithm, if n = 2, you get a superpermutation of length 1 + 2 = 3. For n = 3, this results in a length of 1 + 2 + 6 = 9. For n = 4, you get 33. And for n = 5, you get 153, which corresponds to the shortest superpermutation in each case.For larger n, however, this algorithm no longer applies: computers have been able to find shorter superpermutations than it would suggest exists. In fact, the formula 1! + 2! + 3! + ... + n! massively overestimates the length of the shortest superpermutation for large n. Although the algorithm offers only an approximate answer, mathematicians use it as a starting place, with the goal of narrowing down options to find more precise answers.Coincidences and RediscoveriesIn 2013 Nathaniel Johnston, now a mathematics professor at Mount Allison University in New Brunswick, landed on a Melancholy of Haruhi Suzumiya fandom page. Johnston himself was not an anime fan. He had arrived at the site after Googling some search terms related to superpermutations. There he came across the discussion that had been held on 4chan almost two years earlier, which a user had copied to the fandom site.Johnston didn’t bother doing the math but cited the fandom post on his blog. This comment, too, went unnoticed for several years.Then in October 2018 mathematician Robin Houston came across his colleague’s blog post through a curious coincidence. Houston had just learned that Australian science fiction author Greg Egan had found a new maximum length for the shortest superpermutations, expressed as:n! +(n –1)! + (n – 2)! + (n – 3)! + n – 3That in itself was bizarre. But when Houston started learning more about this result, he realized that the minimum length of a superpermutation had been given a new value by an anonymous anime fandom user (he didn’t know about the origins on 4chan at that time). The formula for the minimum length is:n! +(n – 1)! + (n – 2)! + n – 3Houston shared his discovery on Twitter (now X) on October 23 of that year. “A curious situation. The best known lower bound for the minimal length of superpermutations was proven by an anonymous user of a wiki mainly devoted to anime,” he wrote.Along with his colleagues, mathematicians Jay Pantone and Vince Vatter, Houston decided to check the 4chan user’s proof and write it down in a mathematical way. The researchers posted their mathematical work to the Online Encyclopedia of Integer Sequences that same month, and the first author is listed as “Anonymous 4chan Poster.”So what do these formulas tell us? If you want to watch all episodes of an n-part series in all possible combinations, you must sit through at least n! +(n – 1)! + (n – 2)! + n – 3 episodes—that’s the 4chan user’s contribution—and at most n! +(n – 1)! + (n – 2)! + (n – 3)! + n – 3, which we know through Egan’s work.In the case of the eight-episode series Kaleidoscope, you would have to watch at least 46,085 and, at most, 46,205 episodes. For The Melancholy of Haruhi Suzumiya, or Haruhi, with 14 episodes, the number increases drastically: a minimum of 93,884,313,611 episodes and a maximum of 93,924,230,411. Recall that this is not a complete solution—it’s just setting a range for the size of a superpermutation that would allow you to efficiently watch the series in every possible order.Fortunately, Egan also provided an algorithm for constructing the corresponding superpermutation. This allows Haruhi fans to work out the best viewing order of episodes. But with an average episode length of around 24 minutes, it would take about 4 million years to sit through this superpermutation.",
  "image": "https://static.scientificamerican.com/dam/m/2de9aff25131692e/original/-Anime_Japan-2014.jpg?m=1740758177.232\u0026w=1200",
  "html": "\u003cdiv id=\"readability-page-1\" class=\"page\"\u003e\u003cdiv\u003e\u003cp data-block=\"sciam/paragraph\"\u003eMath solutions can be found in surprising places, including the dark realms of the Internet. In 2011 an anonymous poster on the now infamously controversial image board 4chan posed a mathematical puzzle about the cult classic anime series \u003ci\u003eThe Melancholy of Haruhi Suzumiya\u003c/i\u003e. Though the bulletin board has become littered with hateful, violent and extreme content, that original post led to a solution to the sophisticated math problem.\u003c/p\u003e\u003cp data-block=\"sciam/paragraph\"\u003eThe first season of this anime series consists of 14 episodes that were designed so that you can watch them in any order you like. (For people who are as unfamiliar with the anime world as I am: an eight-part live-action thriller called \u003ci\u003eKaleidoscope\u003c/i\u003e on Netflix follows the same principle.) At some point in a 2011 discussion of the series on 4chan, someone asked the minimum number of episodes they would have to watch to have seen it in every possible order.\u003c/p\u003e\u003cp data-block=\"sciam/paragraph\"\u003eIn fact, this question is related to so-called superpermutations. And as it turns out, this mathematical area holds many puzzles: to this day, mathematicians are still unable to fully answer the problem that the 4chan user had posed.\u003c/p\u003e\u003chr/\u003e\u003ch2\u003eOn supporting science journalism\u003c/h2\u003e\u003cp\u003eIf you\u0026#39;re enjoying this article, consider supporting our award-winning journalism by \u003ca href=\"https://www.scientificamerican.com/getsciam/\"\u003esubscribing\u003c/a\u003e. By purchasing a subscription you are helping to ensure the future of impactful stories about the discoveries and ideas shaping our world today.\u003c/p\u003e\u003chr/\u003e\u003cp data-block=\"sciam/paragraph\"\u003eBut amazingly, in that discussion, one of the anonymous users made an estimate of the minimum amount of all episodes to watch with an approach that was previously unknown to mathematicians. “I’ll need to [elaborate on] this in multiple posts. Please look it over for any loopholes I might have missed,” wrote the user, who explained in several steps how they arrived at their estimate. Other users then took up the arguments and discussed them—but outside of 4chan, none of this made any waves. No one seemed to take any notice.\u003c/p\u003e\u003ch2 id=\"extreme-binge-watching\" data-block=\"sciam/heading\"\u003eExtreme Binge-Watching\u003c/h2\u003e\u003cp data-block=\"sciam/paragraph\"\u003eIn mathematics, two objects permutate when they are rearranged or recombined. For example, you can permutate AB to BA. If an anime series consisted of only two parts, you could either watch the first and then the second episode (1-2) or the second and then the first (2-1).\u003c/p\u003e\u003cp data-block=\"sciam/paragraph\"\u003eIf you want to watch a series in multiple arrangements—perhaps to figure out which sequence of episodes makes the most sense—you need a superpermutation. This is a sequence of all possible permutations. Imagine a marathon showing where you watch the first episode, followed by the second, and then watch the second episode, followed by the first (1-2-2-1). To avoid watching the second episode twice in a row, a shorter superpermutation would be 1-2-1; you would only have to watch three episodes to still have every possible order covered.\u003c/p\u003e\u003cp data-block=\"sciam/paragraph\"\u003eIf a series consists of three episodes, it becomes a little trickier to find the shortest superpermutation. In this case, there are 3! = 6 different sequences: 1-2-3, 1-3-2, 2-3-1, 2-1-3, 3-1-2, 3-2-1. Fortunately, you don’t have to watch 3 × 6 = 18 parts but can find a clever shortcut, in this case: 1-2-3-1-2-1-3-2-1. That order contains all possible permutations of the numbers 1, 2 and 3, but you only have to watch nine episodes!\u003c/p\u003e\u003cp data-block=\"sciam/paragraph\"\u003eMathematicians have also calculated the shortest superpermutations for a series consisting of \u003ci\u003en\u003c/i\u003e = 4 and \u003ci\u003en\u003c/i\u003e = 5 episodes (33 and 153 episodes, respectively). Beyond that, however, they are in the dark. The shortest superpermutations for \u003ci\u003en\u003c/i\u003e \u0026gt; 5 are not known.\u003c/p\u003e\u003cp data-block=\"sciam/paragraph\"\u003eIn fact, the challenge relates to one of the most intractable problems in algorithmics: \u003ca href=\"https://www.scientificamerican.com/article/the-math-mystery-that-connects-sudoku-flight-schedules-and-protein-folding/\"\u003ethe traveling salesperson problem\u003c/a\u003e. In this problem, a person wants to visit different cities and end up back in their hometown. The task is to find the shortest route that connects all the cities. The shortest superpermutation is a variation of this problem in which the individual permutations represent different cities. In this case, you assign different distances between cities by determining the overlap of the permutations. For example, cities 1-2-3 and 2-3-1 have a large overlap: the last two digits of the first permutation match the first two digits of the second, so they can be combined to form 1-2-3-1. We can therefore assign a short distance between those two cities. On the other hand, 1-2-3 and 2-1-3 do not overlap. (To see both sequences, you have to look at a full six parts; no shortcut is possible.) Thus, these cities have a large distance between them.\u003c/p\u003e\u003cp data-block=\"sciam/paragraph\"\u003eTo find the shortest route within permutations, you connect the permutations that overlap the most. There is only one difficulty: there is no known algorithm that solves the traveling salesperson problem quickly. If we are dealing with a few cities—or, in the case of an anime series, a few episodes—this is not a major drawback. But as soon as the \u003ci\u003en\u003c/i\u003e becomes large, computers fail at the task because the computing time grows exponentially with \u003ci\u003en\u003c/i\u003e.\u003c/p\u003e\u003cp data-block=\"sciam/paragraph\"\u003eComputers are able to calculate superpermutations for \u003ci\u003en\u003c/i\u003e = 4 and \u003ci\u003en\u003c/i\u003e = 5 but not for anything beyond that. And although it is possible to calculate elaborate superpermutations for larger numbers, finding the shortest superpermutation becomes more difficult.\u003c/p\u003e\u003cp data-block=\"sciam/paragraph\"\u003eExperts must therefore make do with estimates. For example, there is an algorithm that helps estimate the length of the shortest possible superpermutation for \u003ci\u003en\u003c/i\u003e objects: 1! + 2! + 3! + ... + \u003ci\u003en\u003c/i\u003e! Using that algorithm, if \u003ci\u003en\u003c/i\u003e = 2, you get a superpermutation of length 1 + 2 = 3. For \u003ci\u003en\u003c/i\u003e = 3, this results in a length of 1 + 2 + 6 = 9. For \u003ci\u003en\u003c/i\u003e = 4, you get 33. And for \u003ci\u003en\u003c/i\u003e = 5, you get 153, which corresponds to the shortest superpermutation in each case.\u003c/p\u003e\u003cp data-block=\"sciam/paragraph\"\u003eFor larger \u003ci\u003en,\u003c/i\u003e however, this algorithm no longer applies: computers have been able to find shorter superpermutations than it would suggest exists. In fact, the formula 1! + 2! + 3! + ... + \u003ci\u003en\u003c/i\u003e! massively overestimates the length of the shortest superpermutation for large \u003ci\u003en\u003c/i\u003e. Although the algorithm offers only an approximate answer, mathematicians use it as a starting place, with the goal of narrowing down options to find more precise answers.\u003c/p\u003e\u003ch2 id=\"coincidences-and-rediscoveries\" data-block=\"sciam/heading\"\u003eCoincidences and Rediscoveries\u003c/h2\u003e\u003cp data-block=\"sciam/paragraph\"\u003eIn 2013 Nathaniel Johnston, now a mathematics professor at Mount Allison University in New Brunswick, landed on a \u003ci\u003eMelancholy of Haruhi Suzumiya\u003c/i\u003e fandom page. Johnston himself was not an anime fan. He had arrived at the site after Googling some search terms related to superpermutations. There he came across the discussion that had been held on 4chan almost two years earlier, which a user had copied to the fandom site.\u003c/p\u003e\u003cp data-block=\"sciam/paragraph\"\u003eJohnston didn’t bother doing the math \u003ca href=\"http://www.njohnston.ca/2013/04/the-minimal-superpermutation-problem/\"\u003ebut cited the fandom post on his blog\u003c/a\u003e. This comment, too, went unnoticed for several years.\u003c/p\u003e\u003cp data-block=\"sciam/paragraph\"\u003eThen in October 2018 mathematician Robin Houston came across his colleague’s blog post through a curious coincidence. Houston had just learned that Australian science fiction author Greg Egan had found a new \u003ci\u003emaximum \u003c/i\u003elength for the shortest superpermutations, expressed as:\u003c/p\u003e\u003cp data-block=\"sciam/paragraph\"\u003e\u003ci\u003en\u003c/i\u003e! +(\u003ci\u003en\u003c/i\u003e –1)! + (\u003ci\u003en\u003c/i\u003e – 2)! + (\u003ci\u003en\u003c/i\u003e – 3)! + \u003ci\u003en \u003c/i\u003e– 3\u003c/p\u003e\u003cp data-block=\"sciam/paragraph\"\u003eThat in itself was bizarre. But when Houston started learning more about this result, he realized that the minimum length of a superpermutation had been given a new value by an anonymous anime fandom user (he didn’t know about the origins on 4chan at that time). The formula for the minimum length is:\u003c/p\u003e\u003cp data-block=\"sciam/paragraph\"\u003e\u003ci\u003en\u003c/i\u003e! +(\u003ci\u003en\u003c/i\u003e – 1)! + (\u003ci\u003en\u003c/i\u003e – 2)! + \u003ci\u003en\u003c/i\u003e – 3\u003c/p\u003e\u003cp data-block=\"sciam/paragraph\"\u003eHouston shared \u003ca href=\"https://x.com/robinhouston/status/1054637891085918209?ref_src=twsrc%5Etfw%7Ctwcamp%5Etweetembed%7Ctwterm%5E1054637891085918209%7Ctwgr%5Eaa026a45fed15b42edf702c30c79bae8cc6e60c7%7Ctwcon%5Es1_\u0026amp;ref_url=https%3A%2F%2Fwww.spektrum.de%2Fkolumne%2Fsuperpermutation-und-anime-4chan-user-gelingt-mathematischer-beweis%2F2251925\"\u003ehis discovery on Twitter\u003c/a\u003e (now X) on October 23 of that year. “A curious situation. The best known lower bound for the minimal length of superpermutations was proven by an anonymous user of a wiki mainly devoted to anime,” he wrote.\u003c/p\u003e\u003cp data-block=\"sciam/paragraph\"\u003eAlong with his colleagues, mathematicians Jay Pantone and Vince Vatter, Houston decided to check the 4chan user’s proof and write it down in a mathematical way. \u003ca href=\"https://oeis.org/A180632/a180632.pdf\"\u003eThe researchers posted their mathematical work\u003c/a\u003e to the Online Encyclopedia of Integer Sequences that same month, and the first author is listed as “Anonymous 4chan Poster.”\u003c/p\u003e\u003cp data-block=\"sciam/paragraph\"\u003eSo what do these formulas tell us? If you want to watch all episodes of an \u003ci\u003en\u003c/i\u003e-part series in all possible combinations, you must sit through at least \u003ci\u003en\u003c/i\u003e! +(\u003ci\u003en \u003c/i\u003e– 1)! + (\u003ci\u003en\u003c/i\u003e – 2)! + \u003ci\u003en\u003c/i\u003e – 3 episodes—that’s the 4chan user’s contribution—and at most \u003ci\u003en\u003c/i\u003e! +(\u003ci\u003en\u003c/i\u003e – 1)! + (\u003ci\u003en\u003c/i\u003e – 2)! + (\u003ci\u003en\u003c/i\u003e – 3)! + \u003ci\u003en\u003c/i\u003e – 3, which we know through Egan’s work.\u003c/p\u003e\u003cp data-block=\"sciam/paragraph\"\u003eIn the case of the eight-episode series \u003ci\u003eKaleidoscope,\u003c/i\u003e you would have to watch at least 46,085 and, at most, 46,205 episodes. For \u003ci\u003eThe Melancholy of Haruhi Suzumiya, \u003c/i\u003eor \u003ci\u003eHaruhi,\u003c/i\u003e with 14 episodes, the number increases drastically: a minimum of 93,884,313,611 episodes and a maximum of 93,924,230,411. Recall that this is not a complete solution—it’s just setting a range for the size of a superpermutation that would allow you to efficiently watch the series in every possible order.\u003c/p\u003e\u003cp data-block=\"sciam/paragraph\"\u003eFortunately, Egan also provided an algorithm for constructing the corresponding superpermutation. This allows \u003ci\u003eHaruhi\u003c/i\u003e fans to work out the best viewing order of episodes. But with an average episode length of around 24 minutes, it would take about 4 million years to sit through this superpermutation.\u003c/p\u003e\u003c/div\u003e\u003c/div\u003e",
  "readingTime": "10 min read",
  "publishedTime": "2025-03-03T08:00:00-05:00",
  "modifiedTime": null
}
