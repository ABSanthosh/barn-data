{
  "id": "e0b17f44-dd46-49f6-86df-d71766d60ebd",
  "title": "Classic WTF: NoeTimeToken",
  "link": "https://thedailywtf.com/articles/classic-wtf-noetimetoken",
  "description": "Maybe we'll just try and read a book. That's a good way to spend your vacation. This can't possibly go badly! Original --Remy \"Have you had a chance to look at that JIRA ticket yet?\" Marge debated pretending she hadn't seen the Slack message yet—but, if she did, she knew Gary would just walk over to her desk and badger her further. In truth, she didn't want to look at the ticket: it was a low priority ticket, and worse, it only affected a small fraction of one client's customers, meaning it was likely to be some weird edge case bug nobody would ever run into again. Maybe if I ignore it long enough, it'll go away on its own, she thought. The client was a bookseller with a small but signifigant-to-them online presence; the software they used to sell books, including your standard e-commerce account functionality, was made by Marge's company. The bug was somewhere in the password reset feature: some customers, seemingly at random, were unable to use the password reset link the software emailed out. Marge pulled up the ticket, looking over the half-hearted triage work that had been done before it landed on her desk to solve. The previous guy had pulled logs and figured out that all the customers who were complaining were using the same ISP based out of Germany. He'd recommended reaching out to them, but had been transferred to another division before he'd gotten around to it. When Marge realized that the contact information was all in German, she almost gave up then and there. But with the magic of Google Translate, she managed to get in touch with a representative via email. After a bit of back and forth, she noticed this gem in one of his (translated) replies: We want to display mails in our webmail client as close to the original as possible. Since most mails are HTML formatted, the client supports the full HTTP protocol and can display (almost) all HTML tags. Unfortunately, this means that \"evil\" JS-Content in such mails can do all kinds of stuff in the browser and therefore on the customer's PC. To avert this, all mails are processed by a \"SafeBrowsing\"-module before they are displayed, to recognize and circumvent such manipulations. One of those security measures is the recognition of js-modules that begin with \"on...\", since that are mostly js functions that are triggered by some event in the browser. Our \"countermeasure\" is to just replace \"on...\" with \"no...\" before the HTML content is sent to the rendering process. Marge frowned at the answer for a bit, something nagging at her mind. \"There's no way,\" she murmured as she pulled up the access logs. Sure enough, the url for the reset link was something like https://bookseller.com?oneTimeToken=deadbeef ... and the customers in question had accessed https://bookseller.com?noeTimeToken=deadbeef instead. A few lines of code and it was resolved: a conditional would check for the incorrect query string parameter and copy the token to the correct query string parameter instead. Marge rolled her eyes, merged her change into the release branch, and finally, at long last, closed that annoying low-priority ticket once and for all. hljs.initHighlightingOnLoad(); code { font-family: Consolas, monospace; } [Advertisement] Keep the plebs out of prod. Restrict NuGet feed privileges with ProGet. Learn more.",
  "author": "Jane Bailey",
  "published": "Thu, 26 Jun 2025 06:30:00 GMT",
  "source": "http://syndication.thedailywtf.com/TheDailyWtf",
  "categories": [
    "Feature Articles"
  ],
  "byline": "Jane Bailey",
  "length": 3646,
  "excerpt": "Maybe we'll just try and read a book. That's a good way to spend your vacation. This can't possibly go badly! Original --Remy \"Have you had a chance to look at that JIRA ticket yet?\"",
  "siteName": "The Daily WTF",
  "favicon": "",
  "text": "by in Feature Articles on 2025-06-26 Edit Jane BaileyJane Bailey is a self-published author of urban fantasy novels as well as a part-time blogger; in their day job, they're a renaissance person, dabbling in all sorts of fields in search of interesting puzzles and finding mostly WTFs. Maybe we'll just try and read a book. That's a good way to spend your vacation. This can't possibly go badly! Original --Remy \"Have you had a chance to look at that JIRA ticket yet?\" Marge debated pretending she hadn't seen the Slack message yet—but, if she did, she knew Gary would just walk over to her desk and badger her further. In truth, she didn't want to look at the ticket: it was a low priority ticket, and worse, it only affected a small fraction of one client's customers, meaning it was likely to be some weird edge case bug nobody would ever run into again. Maybe if I ignore it long enough, it'll go away on its own, she thought. The client was a bookseller with a small but signifigant-to-them online presence; the software they used to sell books, including your standard e-commerce account functionality, was made by Marge's company. The bug was somewhere in the password reset feature: some customers, seemingly at random, were unable to use the password reset link the software emailed out. Marge pulled up the ticket, looking over the half-hearted triage work that had been done before it landed on her desk to solve. The previous guy had pulled logs and figured out that all the customers who were complaining were using the same ISP based out of Germany. He'd recommended reaching out to them, but had been transferred to another division before he'd gotten around to it. When Marge realized that the contact information was all in German, she almost gave up then and there. But with the magic of Google Translate, she managed to get in touch with a representative via email. After a bit of back and forth, she noticed this gem in one of his (translated) replies: We want to display mails in our webmail client as close to the original as possible. Since most mails are HTML formatted, the client supports the full HTTP protocol and can display (almost) all HTML tags. Unfortunately, this means that \"evil\" JS-Content in such mails can do all kinds of stuff in the browser and therefore on the customer's PC. To avert this, all mails are processed by a \"SafeBrowsing\"-module before they are displayed, to recognize and circumvent such manipulations. One of those security measures is the recognition of js-modules that begin with \"on...\", since that are mostly js functions that are triggered by some event in the browser. Our \"countermeasure\" is to just replace \"on...\" with \"no...\" before the HTML content is sent to the rendering process. Marge frowned at the answer for a bit, something nagging at her mind. \"There's no way,\" she murmured as she pulled up the access logs. Sure enough, the url for the reset link was something like https://bookseller.com?oneTimeToken=deadbeef ... and the customers in question had accessed https://bookseller.com?noeTimeToken=deadbeef instead. A few lines of code and it was resolved: a conditional would check for the incorrect query string parameter and copy the token to the correct query string parameter instead. Marge rolled her eyes, merged her change into the release branch, and finally, at long last, closed that annoying low-priority ticket once and for all. [Advertisement] Keep the plebs out of prod. Restrict NuGet feed privileges with ProGet. Learn more.",
  "image": "https://upload.wikimedia.org/wikipedia/commons/thumb/d/db/Bozen_1_%28201%29.JPG/512px-Bozen_1_%28201%29.JPG",
  "html": "\u003cdiv id=\"readability-page-1\" class=\"page\"\u003e\u003cdiv itemscope=\"\" itemtype=\"http://schema.org/Article\" id=\"article-page\"\u003e\n\n        \n        \u003cp\u003e\u003cspan\u003eby \n            in \u003ca itemprop=\"articleSection\" href=\"https://thedailywtf.com/series/feature-articles\"\u003eFeature Articles\u003c/a\u003e\n            on \u003cspan itemprop=\"datePublished\" content=\"2025-06-26\"\u003e2025-06-26\u003c/span\u003e\n            \u003ca href=\"https://thedailywtf.com/admin/article/edit/10947\" rel=\"nofollow\"\u003eEdit\u003c/a\u003e\n        \u003c/span\u003e\u003c/p\u003e\n        \u003cdiv itemprop=\"author\" itemscope=\"\" itemtype=\"http://schema.org/Person\"\u003e\n            \u003cp\u003e\u003cimg itemprop=\"image\" src=\"https://s3.amazonaws.com/live.thedailywtf.com/images/0ac7de80-5d20-44b2-b989-83823944fd87.jpeg\"/\u003e\n            \u003ca itemprop=\"name\" href=\"https://thedailywtf.com/authors/jane-bailey\"\u003eJane Bailey\u003c/a\u003e\u003c/p\u003e\u003cp itemprop=\"description\"\u003eJane Bailey is a self-published author of urban fantasy novels as well as a part-time blogger; in their day job, they\u0026#39;re a renaissance person, dabbling in all sorts of fields in search of interesting puzzles and finding mostly WTFs.\u003c/p\u003e\n        \u003c/div\u003e\n        \u003cdiv itemprop=\"articleBody\"\u003e\n            \u003cblockquote\u003eMaybe we\u0026#39;ll just try and read a book. That\u0026#39;s a good way to spend your vacation. This can\u0026#39;t possibly go badly! \u003ca href=\"https://thedailywtf.com/articles/noetimetoken\"\u003eOriginal\u003c/a\u003e --\u003cstrong\u003eRemy\u003c/strong\u003e\u003c/blockquote\u003e\n\n\u003cp\u003e\u003ca title=\"By User:Mattes [Public domain], from Wikimedia Commons\" href=\"https://commons.wikimedia.org/wiki/File:Bozen_1_(201).JPG\"\u003e\u003cimg itemprop=\"image\" width=\"300\" alt=\"Bozen 1 (201)\" src=\"https://upload.wikimedia.org/wikipedia/commons/thumb/d/db/Bozen_1_%28201%29.JPG/512px-Bozen_1_%28201%29.JPG\"/\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u0026#34;Have you had a chance to look at that JIRA ticket yet?\u0026#34;\u003c/p\u003e\n\n\u003cp\u003e\u003cb\u003eMarge\u003c/b\u003e debated pretending she hadn\u0026#39;t seen the Slack message yet—but, if she did, she knew Gary would just walk over to her desk and badger her further. In truth, she didn\u0026#39;t want to look at the ticket: it was a low priority ticket, and worse, it only affected a small fraction of one client\u0026#39;s customers, meaning it was likely to be some weird edge case bug nobody would ever run into again. \u003ci\u003eMaybe if I ignore it long enough, it\u0026#39;ll go away on its own,\u003c/i\u003e she thought.\u003c/p\u003e\n\n\u003cp\u003eThe client was a bookseller with a small but signifigant-to-them online presence; the software they used to sell books, including your standard e-commerce account functionality, was made by Marge\u0026#39;s company. The bug was somewhere in the password reset feature: some customers, seemingly at random, were unable to use the password reset link the software emailed out.\u003c/p\u003e\n\n\u003cp\u003eMarge pulled up the ticket, looking over the half-hearted triage work that had been done before it landed on her desk to solve. The previous guy had pulled logs and figured out that all the customers who were complaining were using the same ISP based out of Germany. He\u0026#39;d recommended reaching out to them, but had been transferred to another division before he\u0026#39;d gotten around to it.\u003c/p\u003e\n\n\u003cp\u003eWhen Marge realized that the contact information was all in German, she almost gave up then and there. But with the magic of Google Translate, she managed to get in touch with a representative via email. After a bit of back and forth, she noticed this gem in one of his (translated) replies:\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eWe want to display mails in our webmail client as close to the original as possible. Since most mails are HTML formatted, the client supports the full HTTP protocol and can display (almost) all HTML tags. Unfortunately, this means that \u0026#34;evil\u0026#34; JS-Content in such mails can do all kinds of stuff in the browser and therefore on the customer\u0026#39;s PC.\u003c/p\u003e\n\u003cp\u003eTo avert this, all mails are processed by a \u0026#34;SafeBrowsing\u0026#34;-module before they are displayed, to recognize and circumvent such manipulations.\nOne of those security measures is the recognition of js-modules that begin with \u0026#34;on...\u0026#34;, since that are mostly js functions that are triggered by some event in the browser. Our \u0026#34;countermeasure\u0026#34; is to just replace \u0026#34;on...\u0026#34; with \u0026#34;no...\u0026#34; before the HTML content is sent to the rendering process.\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eMarge frowned at the answer for a bit, something nagging at her mind. \u0026#34;There\u0026#39;s no way,\u0026#34; she murmured as she pulled up the access logs. Sure enough, the url for the reset link was something like \u003ccode\u003ehttps://bookseller.com?oneTimeToken=deadbeef\u003c/code\u003e ... and the customers in question had accessed \u003ccode\u003ehttps://bookseller.com?noeTimeToken=deadbeef\u003c/code\u003e instead.\u003c/p\u003e\n\n\u003cp\u003eA few lines of code and it was resolved: a conditional would check for the incorrect query string parameter and copy the token to the correct query string parameter instead. Marge rolled her eyes, merged her change into the release branch, and finally, at long last, closed that annoying low-priority ticket once and for all.\u003c/p\u003e\n\n\n\n\n\n\u003cp\u003e\u003cimg src=\"https://thedailywtf.com/images/inedo/proget-icon.png\"/\u003e [Advertisement] \n\tKeep the plebs out of prod. Restrict NuGet feed privileges with ProGet. \u003ca href=\"https://inedo.com/proget/private-nuget-server?utm_source=tdwtf\u0026amp;utm_medium=footer\u0026amp;utm_content=PlebsFooter\u0026amp;utm_campaign=Cyclops2020\"\u003eLearn more.\u003c/a\u003e\n\u003c/p\u003e\n\n\n        \u003c/div\u003e\n\n        \n    \u003c/div\u003e\u003c/div\u003e",
  "readingTime": "5 min read",
  "publishedTime": "2025-06-26T06:30:00Z",
  "modifiedTime": null
}
